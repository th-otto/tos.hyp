<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
<head>
<title>
The documentation for TOS: Date and Time
</title>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<meta name="Generator" content="UDO 7.04 (1296) for Linux">
</head>
<body>
<? include "/var/www/banner.php"; ?>

<a id="UDO_nav_hm_HEAD" href="index.html"><img src="udo_hm.gif" alt="Home" title="Home" border="0" width="24" height="24"></a><a id="UDO_nav_up_HEAD" href="005.html"><img src="udo_up.gif" alt="GEMDOS" title="GEMDOS" border="0" width="24" height="24"></a><a id="UDO_nav_lf_HEAD" href="005009.html"><img src="udo_lf.gif" alt="File functions" title="File functions" border="0" width="24" height="24"></a><a id="UDO_nav_rg_HEAD" href="00500b.html"><img src="udo_rg.gif" alt="Process functions" title="Process functions" border="0" width="24" height="24"></a>
<hr>

<h1><a name="Date_20and_20Time"></a>5.10 Date and Time</h1>
<table>
<tr><td nowrap="nowrap" valign="top">• <a href="#Talarm">Talarm</a>&nbsp;&nbsp;&nbsp;&nbsp;</td>
<td valign="top">Alarm function.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#Tgetdate">Tgetdate</a>&nbsp;&nbsp;</td>
<td valign="top">Obtains date.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#Tgettime">Tgettime</a>&nbsp;&nbsp;</td>
<td valign="top">Obtains time.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#Tgettimeofday">Tgettimeofday</a></td>
<td valign="top">Interrogates the state of the internal, high resolution system
clock.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#Tmalarm">Tmalarm</a>&nbsp;&nbsp;&nbsp;</td>
<td valign="top">Reads/sets a process alarm for the current process.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#Tsetdate">Tsetdate</a>&nbsp;&nbsp;</td>
<td valign="top">Sets date.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#Tsetitimer">Tsetitimer</a></td>
<td valign="top">Sets a periodical timer.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#Tsettime">Tsettime</a>&nbsp;&nbsp;</td>
<td valign="top">Sets time.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#Tsettimeofday">Tsettimeofday</a></td>
<td valign="top">Sets the state of the internal, high resolution system clock.

</td></tr>
</table>

<p>See also: <a href="004009.html">Date and Time in XBIOS</a></p>

<h3><a name="Talarm"></a>5.10.1 Talarm</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»Talarm« - Reads/sets a process alarm for the current
process.</td></tr>

<tr><td nowrap="nowrap" valign="top">Opcode:</td>
<td valign="top">288 (0x0120)</td></tr>

<tr><td nowrap="nowrap" valign="top">Syntax:</td>
<td valign="top">int32_t Talarm ( int32_t time );</td></tr>

<tr><td nowrap="nowrap" valign="top">Description:</td>
<td valign="top">The function Talarm sends a <a href="005007.html#SIGALRM">SIGALRM</a> signal to the calling
process after <i>time</i> seconds.<br><br>

If no signal-handler was installed for this signal with <a href="00500b.html#Psignal">Psignal</a>,
then the process will be terminated immediately (i.e. on receiving the
signal).<br><br>

By setting the value of <i>time</i> = 0, an earlier set alarm can
be cancelled. If <i>time</i> is negative, then the function has no
effect and only the return value is delivered.</td></tr>

<tr><td nowrap="nowrap" valign="top">Return value:</td>
<td valign="top"> The function returns the time (in seconds) remaining before
the SIGALRM signal is triggered (if an alarm has been activated), or
otherwise the value 0 if no alarm was scheduled before this call.</td></tr>

<tr><td nowrap="nowrap" valign="top">Availability:</td>
<td valign="top">As of the first in MultiTOS integrated MiNT version 1.04.<br><br>

The call was introduced in the MiNT version 0.8pl8, but prior to
the version 1.12 the code contained a bug that affected its
functionality.</td></tr>

<tr><td nowrap="nowrap" valign="top">Group:</td>
<td valign="top"><a href="#Date_20and_20Time">Date and Time</a></td></tr>

<tr><td nowrap="nowrap" valign="top">See also:</td>
<td valign="top"><a href="#Bindings_20for_20Talarm">Binding</a> &nbsp; <a href="#Tmalarm">Tmalarm</a> &nbsp; <a href="00500b.html#Pause">Pause</a> &nbsp; <a href="00500b.html#Psignal">Psignal</a> &nbsp; Signale

</td></tr>
</table>

<h4><a name="Bindings_20for_20Talarm"></a>5.10.1.1 Bindings for Talarm</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">int32_t <a href="#Talarm">Talarm</a> ( int32_t time );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>move.l    time,-(sp)   ; Offset 2
move.w    #288,-(sp)   ; Offset 0
trap      #1           ; <a href="005.html">GEMDOS</a>
addq.l    #6,sp        ; Correct stack
</pre>


</td></tr>
</table>

<h3><a name="Tgetdate"></a>5.10.2 Tgetdate</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»get date« - Obtain date.</td></tr>

<tr><td nowrap="nowrap" valign="top">Opcode:</td>
<td valign="top">42</td></tr>

<tr><td nowrap="nowrap" valign="top">Syntax:</td>
<td valign="top">uint32_t Tgetdate ( void );</td></tr>

<tr><td nowrap="nowrap" valign="top">Description:</td>
<td valign="top">The GEMDOS routine Tgetdate obtains the current date.</td></tr>

<tr><td nowrap="nowrap" valign="top">Return value:</td>
<td valign="top"> The function returns a uint32_t number with the date, which is
coded as follows:<table>
<tr><td nowrap="nowrap" valign="top">Bits</td>
<td valign="top">Meaning</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;</td>
<td valign="top">&nbsp;</td></tr>

<tr><td nowrap="nowrap" valign="top">0-4</td>
<td valign="top">Day (1-31)</td></tr>

<tr><td nowrap="nowrap" valign="top">5-8</td>
<td valign="top">Month (1-12)</td></tr>

<tr><td nowrap="nowrap" valign="top">9-15</td>
<td valign="top">Year (0-119, 0= 1980)

</td></tr>
</table>

</td></tr>

<tr><td nowrap="nowrap" valign="top">Availability:</td>
<td valign="top">All GEMDOS versions.</td></tr>

<tr><td nowrap="nowrap" valign="top">Group:</td>
<td valign="top"><a href="#Date_20and_20Time">Date and Time</a></td></tr>

<tr><td nowrap="nowrap" valign="top">See also:</td>
<td valign="top"><a href="#Bindings_20for_20Tgetdate">Binding</a> &nbsp; <a href="#Tsetdate">Tsetdate</a>

</td></tr>
</table>

<h4><a name="Bindings_20for_20Tgetdate"></a>5.10.2.1 Bindings for Tgetdate</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">uint32_t <a href="#Tgetdate">Tgetdate</a> ( void );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>move.w    #42,-(sp)    ; Offset 0
trap      #1           ; <a href="005.html">GEMDOS</a>
addq.l    #2,sp        ; Correct stack
</pre>


</td></tr>
</table>

<h3><a name="Tgettime"></a>5.10.3 Tgettime</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»Get time« - Obtain the time.</td></tr>

<tr><td nowrap="nowrap" valign="top">Opcode:</td>
<td valign="top">44</td></tr>

<tr><td nowrap="nowrap" valign="top">Syntax:</td>
<td valign="top">uint32_t Tgettime ( void );</td></tr>

<tr><td nowrap="nowrap" valign="top">Description:</td>
<td valign="top">The GEMDOS routine Tgettime obtains the system time.</td></tr>

<tr><td nowrap="nowrap" valign="top">Return value:</td>
<td valign="top"> The function returns the system time, coded as follows:<table>
<tr><td nowrap="nowrap" valign="top">Bits</td>
<td valign="top">Meaning</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;</td>
<td valign="top">&nbsp;</td></tr>

<tr><td nowrap="nowrap" valign="top">0-4</td>
<td valign="top">Seconds in units of two (0-29)</td></tr>

<tr><td nowrap="nowrap" valign="top">5-10</td>
<td valign="top">Minutes (0-59)</td></tr>

<tr><td nowrap="nowrap" valign="top">11-15</td>
<td valign="top">Hours (0-23)

</td></tr>
</table>

</td></tr>

<tr><td nowrap="nowrap" valign="top">Availability:</td>
<td valign="top">All GEMDOS versions.</td></tr>

<tr><td nowrap="nowrap" valign="top">Group:</td>
<td valign="top"><a href="#Date_20and_20Time">Date and Time</a></td></tr>

<tr><td nowrap="nowrap" valign="top">See also:</td>
<td valign="top"><a href="#Bindings_20for_20Tgettime">Binding</a> &nbsp; <a href="#Tsettime">Tsettime</a>

</td></tr>
</table>

<h4><a name="Bindings_20for_20Tgettime"></a>5.10.3.1 Bindings for Tgettime</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">uint32_t <a href="#Tgettime">Tgettime</a> ( void );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>move.w    #44,-(sp)    ; Offset 0
trap      #1           ; <a href="005.html">GEMDOS</a>
addq.l    #2,sp        ; Correct stack
</pre>


</td></tr>
</table>

<h3><a name="Tgettimeofday"></a>5.10.4 Tgettimeofday</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»Tgettimeofday« - Interrogate the state of the internal, high
resolution system clock.</td></tr>

<tr><td nowrap="nowrap" valign="top">Opcode:</td>
<td valign="top">341 (0x0155)</td></tr>

<tr><td nowrap="nowrap" valign="top">Syntax:</td>
<td valign="top">int32_t Tgettimeofday ( <a href="005014.html#timeval">timeval</a> *tv, <a href="005014.html#timezone">timezone</a> *tzp );</td></tr>

<tr><td nowrap="nowrap" valign="top">Description:</td>
<td valign="top">The function Tgettimeofday interrogates the state of the
internal, high resolution system clock.<br><br>

The argument <i>tv</i> is a pointer to the <a href="005014.html#timeval">timeval</a> structure.<br><br>

The argument <i>tzp</i> is a pointer to <a href="005014.html#timezone">timezone</a> structure.<br><br>

You may safely pass NULL for either argument. This isn't
considered an error.<br><br>

Implementors of library bindings should be aware that the
definition of struct timezone is non-standard. The members are actually
int and not long int (this applies only to struct timezone; the members
of struct timeval are always long). 16-bit libraries will have to copy
the contents of the structure that tzp points to.<br><br>

The <a href="00500e.html#Ssystem">Ssystem</a>() call has a command <a href="00500e.html#S_CLOCKMODE">S_CLOCKMODE</a>. This command allows
to retrieve or set the kernel clock mode, i.e. to specify whether the
hardware clock is meant to run in UTC or in local time.
<br>It is planned to make MiNT compliant with the kernel time keeping
model described in RFC1305. This model is already successfully
implemented in operating systems such as SunOS, Ultrix, OSF/1, HP-UX
and Linux. Please expect the internal realization to change in the
future.</td></tr>

<tr><td nowrap="nowrap" valign="top">Return value:</td>
<td valign="top"> The function can never fail. It always returns <a href="005003.html#E_OK">E_OK</a>.</td></tr>

<tr><td nowrap="nowrap" valign="top">Availability:</td>
<td valign="top">Available when a MiNT kernel of a version at least 1.15.0
release is detected.</td></tr>

<tr><td nowrap="nowrap" valign="top">Group:</td>
<td valign="top"><a href="#Date_20and_20Time">Date and Time</a></td></tr>

<tr><td nowrap="nowrap" valign="top">See also:</td>
<td valign="top"><a href="#Bindings_20for_20Tgettimeofday">Binding</a> &nbsp; <a href="00500e.html#Ssystem">Ssystem</a> &nbsp; <a href="#Tsettimeofday">Tsettimeofday</a>

</td></tr>
</table>

<h4><a name="Bindings_20for_20Tgettimeofday"></a>5.10.4.1 Bindings for Tgettimeofday</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">int32_t <a href="#Tgettimeofday">Tgettimeofday</a> ( <a href="005014.html#timeval">timeval</a> *tv, <a href="005014.html#timezone">timezone</a> *tzp );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>pea       tzp          ; Offset 6
pea       tv           ; Offset 2
move.w    #341,-(sp)   ; Offset 0
trap      #1           ; <a href="005.html">GEMDOS</a>
lea       $0a(sp),sp   ; Correct stack
</pre>


</td></tr>
</table>

<h3><a name="Tmalarm"></a>5.10.5 Tmalarm</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»Tmalarm« - Interrogates the state of the internal, high
resolution system clock.</td></tr>

<tr><td nowrap="nowrap" valign="top">Opcode:</td>
<td valign="top">317 (0x013d)</td></tr>

<tr><td nowrap="nowrap" valign="top">Syntax:</td>
<td valign="top">int32_t Tmalarm( int32_t time );</td></tr>

<tr><td nowrap="nowrap" valign="top">Description:</td>
<td valign="top">This function reads/sets a process alarm for the current
process.<br><br>

<i>time</i> specifies the length of time (in milliseconds) to
wait before a <a href="005007.html#SIGALRM">SIGALRM</a> signal is delivered. If time is 0 then any
previously set alarm is cancelled. If time is negative the function
does not modify any alarm currently set.<br><br>

If no SIGALRM signal handler has been set up when the alarm is
triggered, the process will be killed.</td></tr>

<tr><td nowrap="nowrap" valign="top">Return value:</td>
<td valign="top"> Returns 0 if no alarm was scheduled prior to this call or the
amount of time remaining (in milliseconds) before the alarm is
triggered.</td></tr>

<tr><td nowrap="nowrap" valign="top">Availability:</td>
<td valign="top">Available when a 'MiNT' cookie with a version of at least 1.10
exists.</td></tr>

<tr><td nowrap="nowrap" valign="top">Group:</td>
<td valign="top"><a href="#Date_20and_20Time">Date and Time</a></td></tr>

<tr><td nowrap="nowrap" valign="top">See also:</td>
<td valign="top"> <a href="#Bindings_20for_20Tmalarm">Binding</a> &nbsp; <a href="#Talarm">Talarm</a> &nbsp; <a href="00500b.html#Pause">Pause</a> &nbsp; <a href="00500b.html#Psignal">Psignal</a>

</td></tr>
</table>

<h4><a name="Bindings_20for_20Tmalarm"></a>5.10.5.1 Bindings for Tmalarm</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">int32_t <a href="#Tmalarm">Tmalarm</a>( int32_t time );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>move.l    time,-(sp)   ; Offset 2
move.w    #341,-(sp)   ; Offset 0
trap      #1           ; <a href="005.html">GEMDOS</a>
addq.l    #6,sp        ; Correct stack
</pre>


</td></tr>
</table>

<h3><a name="Tsetdate"></a>5.10.6 Tsetdate</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»Set date« - Set the date.</td></tr>

<tr><td nowrap="nowrap" valign="top">Opcode:</td>
<td valign="top">43</td></tr>

<tr><td nowrap="nowrap" valign="top">Syntax:</td>
<td valign="top">int16_t Tsetdate ( uint16_t date );</td></tr>

<tr><td nowrap="nowrap" valign="top">Description:</td>
<td valign="top">The GEMDOS routine Tsetdate sets the current date. The
parameter <i>date</i> is coded as follows:<table>
<tr><td nowrap="nowrap" valign="top">Bits</td>
<td valign="top">Meaning</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;</td>
<td valign="top">&nbsp;</td></tr>

<tr><td nowrap="nowrap" valign="top">0-4</td>
<td valign="top">Day (1-31)</td></tr>

<tr><td nowrap="nowrap" valign="top">5-8</td>
<td valign="top">Month (1-12)</td></tr>

<tr><td nowrap="nowrap" valign="top">9-15</td>
<td valign="top">Year (0-119, 0= 1980)

</td></tr>
</table>

<br><br>

<b>Note:</b> From Blitter-TOS onwards the date is set in the
hardware clock as well (if present).</td></tr>

<tr><td nowrap="nowrap" valign="top">Return value:</td>
<td valign="top"> A return value 0 if the setting was successful, or -1 if the
date format was invalid.</td></tr>

<tr><td nowrap="nowrap" valign="top">Availability:</td>
<td valign="top"> All GEMDOS versions.</td></tr>

<tr><td nowrap="nowrap" valign="top">Group:</td>
<td valign="top"><a href="#Date_20and_20Time">Date and Time</a></td></tr>

<tr><td nowrap="nowrap" valign="top">See also:</td>
<td valign="top"> <a href="#Bindings_20for_20Tsetdate">Binding</a> &nbsp; <a href="#Tgetdate">Tgetdate</a>

</td></tr>
</table>

<h4><a name="Bindings_20for_20Tsetdate"></a>5.10.6.1 Bindings for Tsetdate</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">uint32_t <a href="#Tsetdate">Tsetdate</a> ( uint16_t date );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>move.w    date,-(sp)   ; Offset 2
move.w    #43,-(sp)    ; Offset 0
trap      #1           ; <a href="005.html">GEMDOS</a>
addq.l    #4,sp        ; Correct stack
</pre>


</td></tr>
</table>

<h3><a name="Tsetitimer"></a>5.10.7 Tsetitimer</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»Tsetitimer« - Control a periodic timer.</td></tr>

<tr><td nowrap="nowrap" valign="top">Opcode:</td>
<td valign="top">329 (0x0149)</td></tr>

<tr><td nowrap="nowrap" valign="top">Syntax:</td>
<td valign="top">int32_t Tsetitimer ( int16_t which, int32_t *interval, int32_t
*value, int32_t *ointerval, int32_t *ovalue );</td></tr>

<tr><td nowrap="nowrap" valign="top">Description:</td>
<td valign="top">The GEMDOS routine Tsetitimer controls one of three possible
periodic timers. The following apply:<table>
<tr><td nowrap="nowrap" valign="top">Parameter</td>
<td valign="top">Meaning</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;</td>
<td valign="top">&nbsp;</td></tr>

<tr><td nowrap="nowrap" valign="top">which</td>
<td valign="top">Desired timer<table>
<a name="ITIMER_REAL"></a>
<tr><td nowrap="nowrap" valign="top">0 =</td>
<td valign="top">This timer works in real time, and sends the signal <a href="005007.html#SIGALRM">SIGALRM</a> on
expiry<a name="ITIMER_VIRTUAL"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">1 =</td>
<td valign="top">This timer works in 'virtual process time' and sends the signal
<a href="005007.html#SIGVTALRM">SIGVTALRM</a> on expiry. The timer in this case runs only when the process
that is controlling the timer currently owns the CPU.<a name="ITIMER_PROF"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">2 =</td>
<td valign="top">This timer works both in 'virtual process time' as well as when
the operating system itself is active. On expiry of the timer the
signal <a href="005007.html#SIGPROF">SIGPROF</a> is sent.
</td></tr>
</table>

</td></tr>

<tr><td nowrap="nowrap" valign="top">interval</td>
<td valign="top">Address of an int32_t which holds the value to which the timer
is to be set on expiry. A NULL-pointer means that the corresponding
old value should not be changed. If the int32_t holds the value 0, the
timer will be deactivated after its expiry.</td></tr>

<tr><td nowrap="nowrap" valign="top">value</td>
<td valign="top">Address of an int32_t which holds the initial value of the
timer in milliseconds. A NULL-pointer leaves the current timer
unaffected. If the int32_t holds the value 0, the timer will be
deactivated.</td></tr>

<tr><td nowrap="nowrap" valign="top">ointerval</td>
<td valign="top">Address of an int32_t which holds the current intervall of the
timer, or NULL if this value is of no interest.</td></tr>

<tr><td nowrap="nowrap" valign="top">ovalue</td>
<td valign="top">Address of an int32_t which holds the current value of the
timer, or NULL if this value is of no interest.

</td></tr>
</table>

<br><br>

As all internal calculations are measured in miliseconds, it is
not possible to set a timer to (very large, future) arbitrary values.<br><br>

Setting new interval values needs root privileges.</td></tr>

<tr><td nowrap="nowrap" valign="top">Return value:</td>
<td valign="top"> The function returns 0 when executed correctly, or a a
negative value in case of error.</td></tr>

<tr><td nowrap="nowrap" valign="top">Availability:</td>
<td valign="top">This function is optional, so a call may be answered with
<a href="005003.html#EINVFN">EINVFN</a>. Available when a 'MiNT' cookie with a version of at least 1.11
exists.</td></tr>

<tr><td nowrap="nowrap" valign="top">Group:</td>
<td valign="top"><a href="#Date_20and_20Time">Date and Time</a></td></tr>

<tr><td nowrap="nowrap" valign="top">See also:</td>
<td valign="top"><a href="#Bindings_20for_20Tsetitimer">Binding</a> &nbsp; <a href="00500b.html#Pause">Pause</a> &nbsp; <a href="00500b.html#Psignal">Psignal</a> &nbsp; <a href="#Talarm">Talarm</a>

</td></tr>
</table>

<h4><a name="Bindings_20for_20Tsetitimer"></a>5.10.7.1 Bindings for Tsetitimer</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">int32_t <a href="#Tsetitimer">Tsetitimer</a> ( int16_t which, int32_t *interval, int32_t
*value, int32_t *ointerval, int32_t *ovalue );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>move.l    ovalue,-(sp)    ; Offset 16
move.l    ointerval,-(sp) ; Offset 12
move.l    value,-(sp)     ; Offset  8
move.l    interval,-(sp)  ; Offset  4
move.w    which,-(sp)     ; Offset  2
move.w    #329,-(sp)      ; Offset  0
trap      #1              ; <a href="005.html">GEMDOS</a>
lea       $12(sp),sp      ; Correct stack
</pre>


</td></tr>
</table>

<h3><a name="Tsettime"></a>5.10.8 Tsettime</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»Set time« - Set the time.</td></tr>

<tr><td nowrap="nowrap" valign="top">Opcode:</td>
<td valign="top">45</td></tr>

<tr><td nowrap="nowrap" valign="top">Syntax:</td>
<td valign="top">int16_t Tsettime ( uint16_t time );</td></tr>

<tr><td nowrap="nowrap" valign="top">Description:</td>
<td valign="top">The GEMDOS routine Tsettime sets the time. The parameter
<i>time</i> must be coded as follows:<table>
<tr><td nowrap="nowrap" valign="top">Bits</td>
<td valign="top">Meaning</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;</td>
<td valign="top">&nbsp;</td></tr>

<tr><td nowrap="nowrap" valign="top">0-4</td>
<td valign="top">Seconds in units of two (0-29)</td></tr>

<tr><td nowrap="nowrap" valign="top">5-10</td>
<td valign="top">Minutes (0-59)</td></tr>

<tr><td nowrap="nowrap" valign="top">11-15</td>
<td valign="top">Hours (0-23)

</td></tr>
</table>

<br><br>

<b>Note:</b> From Blitter-TOS 1.02 onwards the time is set in
the hardware clock as well (if present).</td></tr>

<tr><td nowrap="nowrap" valign="top">Return value:</td>
<td valign="top"> A return value 0 if the setting was successful, or -1 if the
time format was invalid.</td></tr>

<tr><td nowrap="nowrap" valign="top">Availability:</td>
<td valign="top">All GEMDOS versions.</td></tr>

<tr><td nowrap="nowrap" valign="top">Group:</td>
<td valign="top"><a href="#Date_20and_20Time">Date and Time</a></td></tr>

<tr><td nowrap="nowrap" valign="top">See also:</td>
<td valign="top"><a href="#Bindings_20for_20Tsettime">Binding</a> &nbsp; <a href="#Tgettime">Tgettime</a>

</td></tr>
</table>

<h4><a name="Bindings_20for_20Tsettime"></a>5.10.8.1 Bindings for Tsettime</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">int16_t <a href="#Tsettime">Tsettime</a> ( uint16_t time );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>move.w    time,-(sp)   ; Offset 2
move.w    #45,-(sp)    ; Offset 0
trap      #1           ; <a href="005.html">GEMDOS</a>
addq.l    #4,sp        ; Correct stack
</pre>


</td></tr>
</table>

<h3><a name="Tsettimeofday"></a>5.10.9 Tsettimeofday</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»Tsettimeofday« - Sets the state of the internal, high
resolution system clock.</td></tr>

<tr><td nowrap="nowrap" valign="top">Opcode:</td>
<td valign="top">342 (0x0156)</td></tr>

<tr><td nowrap="nowrap" valign="top">Syntax:</td>
<td valign="top">int32_t Tsettimeofday ( <a href="005014.html#timeval">timeval</a> *tv, <a href="005014.html#timezone">timezone</a> *tzp );</td></tr>

<tr><td nowrap="nowrap" valign="top">Description:</td>
<td valign="top">The function Tsettimeofday sets the state of the internal, high
resolution system clock.<br><br>

The argument <i>tv</i> is a pointer to the <a href="005014.html#timeval">timeval</a> structure.<br><br>

The argument <i>tzp</i> is a pointer to the <a href="005014.html#timezone">timezone</a> structure.<br><br>

You may safely pass NULL for either argument. This isn't
considered an error.<br><br>

Implementors of library bindings should be aware that the
definition of struct timezone is non-standard. The members are actually
int and not long int (this applies only to struct timezone; the members
of struct timeval are always long). 16-bit libraries will have to copy
the contents of the structure that <i>tzp</i> points to.<br><br>

The tz_dsttime member of timezone is stored, but not evaluated
within the kernel. Beware not to misunderstand its meaning: if
non-zero it simply signifies that daylight savings time applies during
some part of the year, not necessarily now. In other words: if it is
non-zero someday, it should be non-zero during the entire year. The
<a href="00500e.html#Ssystem">Ssystem</a> call has a command <a href="00500e.html#S_CLOCKMODE">S_CLOCKMODE</a>. This command allows retrieval
or setting of the kernel clock mode, i.e. to specify whether the
hardware clock is meant to run in UTC or in local time.(!nl) It is
planned to make MiNT compliant with the kernel timekeeping model
described in RFC1305. This model is already successfully implemented
in operating systems such as SunOS, Ultrix, OSF/1, HP-UX and Linux.
Please expect the internal realization to change in the future.</td></tr>

<tr><td nowrap="nowrap" valign="top">Return value:</td>
<td valign="top"> The following error conditions are defined:<br><br>

<a href="005003.html#EPERM">EPERM</a> - an attempt was made by a user without super-user
privileges to change the system time or system time zone information.<br><br>

<a href="005003.html#EBADARG">EBADARG</a> - one of the arguments is out of range. Note that the
kernel time cannot be set to dates before Jan 1 1980 00:00:00 and
after some day in 2038 (yep, MAX_LONG seconds since the epoch).
Timezone offsets must be in the range of +/- 720 minutes.</td></tr>

<tr><td nowrap="nowrap" valign="top">Availability:</td>
<td valign="top">Available when a MiNT kernel of a version at least 1.15.0
release is detected.</td></tr>

<tr><td nowrap="nowrap" valign="top">Group:</td>
<td valign="top"><a href="#Date_20and_20Time">Date and Time</a></td></tr>

<tr><td nowrap="nowrap" valign="top">See also:</td>
<td valign="top"> <a href="#Bindings_20for_20Tsettimeofday">Binding</a> &nbsp; <a href="00500e.html#Ssystem">Ssystem</a> &nbsp; <a href="#Tgettimeofday">Tgettimeofday</a>

</td></tr>
</table>

<h4><a name="Bindings_20for_20Tsettimeofday"></a>5.10.9.1 Bindings for Tsettimeofday</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">int32_t <a href="#Tsettimeofday">Tsettimeofday</a> ( <a href="005014.html#timeval">timeval</a> *tv, <a href="005014.html#timezone">timezone</a> *tzp );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>pea       tzp          ; Offset 6
pea       tv           ; Offset 2
move.w    #342,-(sp)   ; Offset 0
trap      #1           ; <a href="005.html">GEMDOS</a>
lea       $0a(sp),sp   ; Correct stack
</pre>


</td></tr>
</table>

<hr>

<a id="UDO_nav_hm_FOOT" href="index.html"><img src="udo_hm.gif" alt="Home" title="Home" border="0" width="24" height="24"></a><a id="UDO_nav_up_FOOT" href="005.html"><img src="udo_up.gif" alt="GEMDOS" title="GEMDOS" border="0" width="24" height="24"></a><a id="UDO_nav_lf_FOOT" href="005009.html"><img src="udo_lf.gif" alt="File functions" title="File functions" border="0" width="24" height="24"></a><a id="UDO_nav_rg_FOOT" href="00500b.html"><img src="udo_rg.gif" alt="Process functions" title="Process functions" border="0" width="24" height="24"></a></body>
</html>
