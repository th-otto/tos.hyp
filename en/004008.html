<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
<head>
<title>
The documentation for TOS: CT60 XBIOS extension
</title>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<meta name="Generator" content="UDO 7.04 (1296) for Linux">
</head>
<body>
<? include "/var/www/banner.php"; ?>

<a id="UDO_nav_hm_HEAD" href="index.html"><img src="udo_hm.gif" alt="Home" title="Home" border="0" width="24" height="24"></a><a id="UDO_nav_up_HEAD" href="004.html"><img src="udo_up.gif" alt="XBIOS" title="XBIOS" border="0" width="24" height="24"></a><a id="UDO_nav_lf_HEAD" href="004007.html"><img src="udo_lf.gif" alt="Crazy-Dots XBIOS extension" title="Crazy-Dots XBIOS extension" border="0" width="24" height="24"></a><a id="UDO_nav_rg_HEAD" href="004009.html"><img src="udo_rg.gif" alt="Date, Time and Timer" title="Date, Time and Timer" border="0" width="24" height="24"></a>
<hr>

<h1><a name="CT60_20XBIOS_20extension"></a>4.8 CT60 XBIOS extension</h1>
<table>
<tr><td nowrap="nowrap" valign="top">• <a href="#ct60_cache">ct60_cache</a></td>
<td valign="top">Activate/deactivate the 68060 caches.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#ct60_flush_cache">ct60_flush_cache</a></td>
<td valign="top">Flush 68060 Caches.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#ct60_read_core_temperature">ct60_read_core_temperature</a></td>
<td valign="top">Read the temperature of the 68060.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#ct60_rw_parameter">ct60_rw_parameter</a></td>
<td valign="top">Read or write a parameter in flash Eprom.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#ct60_vmalloc">ct60_vmalloc</a></td>
<td valign="top">Memory allocation (Radeon driver).

</td></tr>
</table>

<h3><a name="ct60_cache"></a>4.8.1 ct60_cache</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»ct60_cache« - Activate/deactivate the 68060 caches.</td></tr>

<tr><td nowrap="nowrap" valign="top">Opcode:</td>
<td valign="top">50700 (0xc60c)</td></tr>

<tr><td nowrap="nowrap" valign="top">Syntax:</td>
<td valign="top">int32_t ct60_cache( int16_t cache_mode );</td></tr>

<tr><td nowrap="nowrap" valign="top">Description:</td>
<td valign="top">This XBIOS function is used to set or remove the 68060 caches
inside the patched version of General.cpx.<table>
<tr><td nowrap="nowrap" valign="top">Parameter</td>
<td valign="top">Meaning</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;</td>
<td valign="top">&nbsp;</td></tr>

<tr><td nowrap="nowrap" valign="top">cache_mode</td>
<td valign="top">&nbsp;1 = Set the caches to on
<br>&nbsp;0 = Remove the caches
<br>-1 = No change

</td></tr>
</table>

<br><br>

<b>Important:</b>
<br>Please use the <a href="004012.html#CacheCtrl">CacheCtrl</a> function.</td></tr>

<tr><td nowrap="nowrap" valign="top">Return value:</td>
<td valign="top"> Returns CACR.</td></tr>

<tr><td nowrap="nowrap" valign="top">Availability:</td>
<td valign="top">TOS 4.04 patched for CT60 hardware acceleration board</td></tr>

<tr><td nowrap="nowrap" valign="top">Group:</td>
<td valign="top"><a href="#CT60_20XBIOS_20extension">CT60 XBIOS extension</a></td></tr>

<tr><td nowrap="nowrap" valign="top">See also:</td>
<td valign="top"><a href="#Bindings_20for_20ct60_cache">Binding</a>

</td></tr>
</table>

<h4><a name="Bindings_20for_20ct60_cache"></a>4.8.1.1 Bindings for ct60_cache</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">int32_t <a href="#ct60_cache">ct60_cache</a>( int16_t cache_mode );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>move.w    cache_mode,-(sp); Offset 2
move.w    #$c60c,-(sp)    ; Offset 0
trap      #14             ; call <a href="004.html">XBIOS</a>
addq.l    #4,sp           ; correct stack
</pre>


</td></tr>
</table>

<h3><a name="ct60_flush_cache"></a>4.8.2 ct60_flush_cache</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»ct60_flush_cache« - Flush 68060 Caches.</td></tr>

<tr><td nowrap="nowrap" valign="top">Opcode:</td>
<td valign="top">50701 (0xc60d)</td></tr>

<tr><td nowrap="nowrap" valign="top">Syntax:</td>
<td valign="top">int32_t ct60_flush_cache( void );</td></tr>

<tr><td nowrap="nowrap" valign="top">Description:</td>
<td valign="top">This XBIOS function is used to flush the instruction and data
caches inside the patched version of Xcontrol.<br><br>

<b>Important:</b>
<br>Please use the <a href="004012.html#CacheCtrl">CacheCtrl</a> function.</td></tr>

<tr><td nowrap="nowrap" valign="top">Return value:</td>
<td valign="top"> <a href="005003.html#E_OK">E_OK</a> (0)</td></tr>

<tr><td nowrap="nowrap" valign="top">Availability:</td>
<td valign="top">TOS 4.04 patched for CT60 hardware acceleration board</td></tr>

<tr><td nowrap="nowrap" valign="top">Group:</td>
<td valign="top"><a href="#CT60_20XBIOS_20extension">CT60 XBIOS extension</a></td></tr>

<tr><td nowrap="nowrap" valign="top">See also:</td>
<td valign="top"><a href="#Bindings_20for_20ct60_flush_cache">Binding</a>

</td></tr>
</table>

<h4><a name="Bindings_20for_20ct60_flush_cache"></a>4.8.2.1 Bindings for ct60_flush_cache</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">int32_t <a href="#ct60_flush_cache">ct60_flush_cache</a>( void );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>move.w    #$c60d,-(sp)    ; Offset 0
trap      #14             ; call <a href="004.html">XBIOS</a>
addq.l    #2,sp           ; correct stack
</pre>


</td></tr>
</table>

<h3><a name="ct60_read_core_temperature"></a>4.8.3 ct60_read_core_temperature</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»ct60_read_core_temperature« - Read the 68060 temperature.</td></tr>

<tr><td nowrap="nowrap" valign="top">Opcode:</td>
<td valign="top">50698 (0xc60a)</td></tr>

<tr><td nowrap="nowrap" valign="top">Syntax:</td>
<td valign="top">int32_t ct60_read_core_temperature( int16_t type_deg );</td></tr>

<tr><td nowrap="nowrap" valign="top">Description:</td>
<td valign="top">This XBIOS function reads the 68060 temperature.<table>
<tr><td nowrap="nowrap" valign="top">type_deg:</td>
<td valign="top">CT60_CELCIUS&nbsp;&nbsp;&nbsp;&nbsp;0
<br>CT60_FARENHEIT&nbsp;&nbsp;1

</td></tr>
</table>

</td></tr>

<tr><td nowrap="nowrap" valign="top">Return value:</td>
<td valign="top"> The value or <a href="003006.html#ERROR">ERROR</a> (-1) if there is a read error.</td></tr>

<tr><td nowrap="nowrap" valign="top">Availability:</td>
<td valign="top">TOS 4.04 patched for CT60 hardware acceleration board.</td></tr>

<tr><td nowrap="nowrap" valign="top">Group:</td>
<td valign="top"><a href="#CT60_20XBIOS_20extension">CT60 XBIOS extension</a></td></tr>

<tr><td nowrap="nowrap" valign="top">See also:</td>
<td valign="top"><a href="#Bindings_20for_20ct60_read_core_temperature">Binding</a>

</td></tr>
</table>

<h4><a name="Bindings_20for_20ct60_read_core_temperature"></a>4.8.3.1 Bindings for ct60_read_core_temperature</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">int32_t <a href="#ct60_read_core_temperature">ct60_read_core_temperature</a>( int16_t type_deg );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>move.w    type_deg,-(sp)  ; Offset 2
move.w    #$c60a,-(sp)    ; Offset 0
trap      #14             ; call <a href="004.html">XBIOS</a>
addq.l    #4,sp           ; correct stack
</pre>


</td></tr>
</table>

<h3><a name="ct60_rw_parameter"></a>4.8.4 ct60_rw_parameter</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»ct60_rw_parameter« -Read or change a parameter inside the
flash eprom.</td></tr>

<tr><td nowrap="nowrap" valign="top">Opcode:</td>
<td valign="top">50699 (0xc60b)</td></tr>

<tr><td nowrap="nowrap" valign="top">Syntax:</td>
<td valign="top">int32_t ct60_rw_parameter( int16_t mode, int32_t type_param,
int16_t value );</td></tr>

<tr><td nowrap="nowrap" valign="top">Description:</td>
<td valign="top">This XBIOS function reads or changes a parameter inside the
flash eprom. The function returns the value.<table>
<tr><td nowrap="nowrap" valign="top">mode</td>
<td valign="top">CT60_MODE_READ (0)
<br>The value is read.<br><br>

CT60_MODE_WRITE (1)
<br>The value is write.</td></tr>

<tr><td nowrap="nowrap" valign="top">type_param</td>
<td valign="top">CT60_PARAM_TOSRAM (0)
<br>If the value is set to 1, the TOS is copied inside the SDRAM
during boot (PMMU used and cookie PMMU created). If the value is set
to 0, the TOS in flash eprom is used.<br><br>

CT60_BLITTER_SPEED (1)
<br>If the value is set to 0, the blitter runs a 8/10 MHz. If the
value is set to 1, the blitter runs a 16/20 MHz.<br><br>

CT60_CACHE_DELAY (2)
<br>If the bit 0 of the value is cleared, the <a href="00500b.html#Pexec">Pexec</a> function is normal
(flushes cache).
<br>If the bit 0 of the value is set, the caches are disabled for 5
seconds when a program is started under TOS with the <a href="00500b.html#Pexec">Pexec</a>
function.
<br>If the bit 1 of the value is set, there are an <a href="005009.html#Fread">Fread</a> test and
maybe a copyback alert if the code begin by $601A. With this alert you
can remove the cache during 5 seconds.
<br>If the bit 1 of the value is cleared, there is no copyback alert.<br><br>

CT60_BOOT_ORDER (3)
<br><u>New boot</u>
<br>If the value is set to 0, TOS boots from SCSI drives (0-7)
before IDE drives (0-1).
<br>If the value is set to 1, TOS boots from IDE drives (0-1)
before SCSI drives (0-7).
<br>If the value is set to 2, TOS boots from SCSI drives (7-0)
before IDE drives (1-0).
<br>If the value is set to 3, TOS boots from IDE drives (1-0)
before SCSI drives (7-0).
<br><br><br>

<u>Old boot</u>
<br>If the value is set to 4, TOS boots from SCSI drives (0-7)
before IDE drives (0-1).
<br>If the value is set to 5, TOS boots from IDE drives (0-1)
before SCSI drives (0-7).
<br>If the value is set to 6, TOS boots from SCSI drives (7-0)
before IDE drives (1-0).
<br>If the value is set to 7, TOS boots from IDE drives (1-0)
before SCSI drives (7-0).
<br><br><br>

CT60_CPU_FPU (4)
<br>If the bit 0 of the <i>value</i> is cleared, the FPU is disabled.<br><br>

CT60_BOOT_LOG (5)
<br>If the bit 0 is cleared, the stdout output of the AUTO folder
files is writed inside a boot.log on the boot drive.<br><br>

CT60_VMODE (6)
<br>Boot extended modecode for CTPCI graphic card: F030 modecode +
extended bits:<br><br>


<div align="left">
<table border="0">
<tr>
  <td align="left" valign="top">HORFLAG</td>
  <td align="right" valign="top">0x200</td>
  <td align="left" valign="top">for double width</td>
</tr>
<tr>
  <td align="left" valign="top">HORFLAG2</td>
  <td align="right" valign="top">0x400</td>
  <td align="left" valign="top">for width increased</td>
</tr>
<tr>
  <td align="left" valign="top">VESA_600</td>
  <td align="right" valign="top">0x800</td>
  <td align="left" valign="top">for SVGA 600</td>
</tr>
<tr>
  <td align="left" valign="top">VESA_768</td>
  <td align="right" valign="top">0x1000</td>
  <td align="left" valign="top">for SVGA 768</td>
</tr>
<tr>
  <td align="left" valign="top">VERTFLAG2</td>
  <td align="right" valign="top">0x2000</td>
  <td align="left" valign="top">for double height</td>
</tr>
<tr>
  <td align="left" valign="top">BPS32</td>
  <td align="right" valign="top">5</td>
  <td align="left" valign="top">for True Color</td>
</tr>
</table>
</div>

<br><br>

CT60_SAVE_NVRAM_1 (7)
<br>CT60_SAVE_NVRAM_2 (8)
<br>CT60_SAVE_NVRAM_3 (9)
<br>Reserved for <a href="002.html">TOS</a> NVM backup, do not use.<br><br>

CT60_PARAM_OFFSET_TLV (10)
<br><i>value</i> contains a signed offset in points. A point is equal
to 2.8 °C.<br><br>

CT60_ABE_CODE (11)
<br>CT60_SDR_CODE (12)
<br>Reserved for save ABE/SDR versions, do not use.<br><br>

CT60_CLOCK (13)
<br>CTPCM boot clock frequency in KHz (65000-110000)
<br>WARNING, if you increase frequency !!!<br><br>

CT60_PARAM_CTPCI (14)
<br>If the bit 0 of the value is cleared, the <a href="002.html">TOS</a> boot on the native
F030 IDE port.
<br>If the bit 0 of the value is set, the <a href="002.html">TOS</a> boot n the CTPCI IDE
port who replaces the F030 at the same address.
<br>If the bit 1 of the value is cleared, the <a href="007.html">VDI</a> not use the CTPCI
PLX DMA (slower for <a href="00700b.html#vro_cpyfm">vro_cpyfm</a>).
<br>If the bit 1 of the value is set, the <a href="007.html">VDI</a> use the CTPCI PLX DMA
(faster for <a href="00700b.html#vro_cpyfm">vro_cpyfm</a>).

</td></tr>
</table>

</td></tr>

<tr><td nowrap="nowrap" valign="top">Return value:</td>
<td valign="top"> The value or return:<table>
<tr><td nowrap="nowrap" valign="top"><a href="003006.html#EBADRQ">EBADRQ</a> (-5)</td>
<td valign="top">if the parameter is >=15.</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="003006.html#EWRITF">EWRITF</a> (-10)</td>
<td valign="top">for a write fault.</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="003006.html#EUNDEV">EUNDEV</a> (-15)</td>
<td valign="top">if the flash device is not found.

</td></tr>
</table>

</td></tr>

<tr><td nowrap="nowrap" valign="top">Availability:</td>
<td valign="top">TOS 4.04 patched for CT60 hardware acceleration board.</td></tr>

<tr><td nowrap="nowrap" valign="top">Group:</td>
<td valign="top"><a href="#CT60_20XBIOS_20extension">CT60 XBIOS extension</a></td></tr>

<tr><td nowrap="nowrap" valign="top">See also:</td>
<td valign="top"><a href="#Bindings_20for_20ct60_rw_parameter">Binding</a>

</td></tr>
</table>

<h4><a name="Bindings_20for_20ct60_rw_parameter"></a>4.8.4.1 Bindings for ct60_rw_parameter</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">int32_t <a href="#ct60_rw_parameter">ct60_rw_parameter</a>( int16_t mode, int32_t type_param,
int16_t value );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>move.l    value,-(sp)     ; Offset 8
move.l    type_param,-(sp); Offset 4
move.w    mode,-(sp)      ; Offset 2
move.w    #$c60b,-(sp)    ; Offset 0
trap      #14             ; call <a href="004.html">XBIOS</a>
addq.l    #12,sp          ; correct stack
</pre>


</td></tr>
</table>

<h3><a name="ct60_vmalloc"></a>4.8.5 ct60_vmalloc</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»ct60_vmalloc« - Memory allocation (Radeon driver).</td></tr>

<tr><td nowrap="nowrap" valign="top">Opcode:</td>
<td valign="top">50702 (0xc60e)</td></tr>

<tr><td nowrap="nowrap" valign="top">Syntax:</td>
<td valign="top">int32_t ct60_vmalloc( int16_t mode, int32_t value )</td></tr>

<tr><td nowrap="nowrap" valign="top">Description:</td>
<td valign="top">This function is used to allocate memory inside the offscreen
area.<br><br>


<div align="left">
<table border="0">
<tr>
  <td align="left" valign="top">mode</td>
  <td align="left" valign="top">&nbsp;</td>
</tr>
<tr>
  <td align="left" valign="top">0</td>
  <td align="left" valign="top"><i>value</i> <=> malloc size, return address or null</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">if memory full</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top"><i>value</i> = -1 => return bytes free ct60_vmalloc(0, -1L).</td>
</tr>
<tr>
  <td align="left" valign="top">1</td>
  <td align="left" valign="top"><i>value</i> <=> address of previous malloc to free.</td>
</tr>
<tr>
  <td align="left" valign="top">2</td>
  <td align="left" valign="top">null <i>value</i> for init. (normally never used excepted</td>
</tr>
<tr>
  <td align="left" valign="top">&nbsp;</td>
  <td align="left" valign="top">by radeon.sys or Vsetscreen)</td>
</tr>
</table>
</div>

</td></tr>

<tr><td nowrap="nowrap" valign="top">Return value:</td>
<td valign="top"> Returns address or null if memory full.<br><br>

<b>Attention!</b>
<br>In all descriptions is the return value define as int32_t. In
reality the value can be higher. Therefore a uint32_t is better.</td></tr>

<tr><td nowrap="nowrap" valign="top">Availability:</td>
<td valign="top">Only valid with internal <a href="002.html">TOS</a> Radeon driver (PCI.HEX). TOS
4.04 patched for CT60 hardware acceleration board (2007-01-24).
<br>Is also present if the <a href="003007.html#Cookie_2C_20SupV">Cookie SupV</a> is there.</td></tr>

<tr><td nowrap="nowrap" valign="top">Group:</td>
<td valign="top"><a href="#CT60_20XBIOS_20extension">CT60 XBIOS extension</a></td></tr>

<tr><td nowrap="nowrap" valign="top">See also:</td>
<td valign="top"><a href="#Bindings_20for_20ct60_vmalloc">Binding</a>

</td></tr>
</table>

<h4><a name="Bindings_20for_20ct60_vmalloc"></a>4.8.5.1 Bindings for ct60_vmalloc</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">int32_t <a href="#ct60_vmalloc">ct60_vmalloc</a>( int16_t mode, int32_t value );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>move.l    value,-(sp)     ; Offset 4
move.w    mode,-(sp)      ; Offset 2
move.w    #$c60e,-(sp)    ; Offset 0
trap      #14             ; call <a href="004.html">XBIOS</a>
addq.l    #8,sp           ; correct stack
</pre>


</td></tr>
</table>

<hr>

<a id="UDO_nav_hm_FOOT" href="index.html"><img src="udo_hm.gif" alt="Home" title="Home" border="0" width="24" height="24"></a><a id="UDO_nav_up_FOOT" href="004.html"><img src="udo_up.gif" alt="XBIOS" title="XBIOS" border="0" width="24" height="24"></a><a id="UDO_nav_lf_FOOT" href="004007.html"><img src="udo_lf.gif" alt="Crazy-Dots XBIOS extension" title="Crazy-Dots XBIOS extension" border="0" width="24" height="24"></a><a id="UDO_nav_rg_FOOT" href="004009.html"><img src="udo_rg.gif" alt="Date, Time and Timer" title="Date, Time and Timer" border="0" width="24" height="24"></a></body>
</html>
