<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
<head>
<title>
The documentation for TOS: BIOS Structures
</title>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<meta name="Generator" content="UDO 7.04 (1296) for Linux">
</head>
<body>
<? include "/var/www/banner.php"; ?>

<a id="UDO_nav_hm_HEAD" href="index.html"><img src="udo_hm.gif" alt="Home" title="Home" border="0" width="24" height="24"></a><a id="UDO_nav_up_HEAD" href="003.html"><img src="udo_up.gif" alt="BIOS" title="BIOS" border="0" width="24" height="24"></a><a id="UDO_nav_lf_HEAD" href="00300a.html"><img src="udo_lf.gif" alt="BIOS function list" title="BIOS function list" border="0" width="24" height="24"></a><a id="UDO_nav_rg_HEAD" href="004.html"><img src="udo_rg.gif" alt="XBIOS" title="XBIOS" border="0" width="24" height="24"></a>
<hr>

<h1><a name="BIOS_20Structures"></a>3.11 BIOS Structures</h1>
<ul class="content">
	<li>3.11.1 <a href="#BPB">BPB</a>
	</li>
	<li>3.11.2 <a href="#MD">MD</a>
	</li>
	<li>3.11.3 <a href="#MPB">MPB</a>
	</li>
	<li>3.11.4 <a href="#patternrectdata">patternrectdata</a>
	</li>
	<li>3.11.5 <a href="#PUN_INFO">PUN_INFO</a>
	</li>
	<li>3.11.6 <a href="#solidrectdata">solidrectdata</a>
	</li>
</ul>

<h3><a name="BPB"></a>3.11.1 BPB</h3>
<pre>typedef struct
{
  WORD   recsiz;       /* Bytes per sector                     */
  WORD   clsiz;        /* Sectors per cluster                  */
  WORD   clsizb;       /* Bytes per cluster                    */
  WORD   rdlen;        /* Directory length                     */
  WORD   fsiz;         /* Length of the FAT                    */
  WORD   fatrec;       /* Start of the 2nd FAT                 */
  WORD   datrec;       /* 1st free sector                      */
  WORD   numcl;        /* Total numbr of clusters              */
  WORD   bflags;       /* Flags as bit-vector                  */
                       /* Bit 0: 0 (12-Bit-FAT), 1 16-Bit-FAT  */
                       /* Bit 1: 0 (two FATs), 1 (one FAT)     */
                       /*        only available since <a href="002.html">TOS</a> 2.06 */
} BPB ;
</pre>
<p>See also: <a href="About_the_BIOS.html#Getbpb">Getbpb</a></p>

<h3><a name="MD"></a>3.11.2 MD</h3>
<pre>typedef struct
{
     MD *m_link;         /* Next MD (or NULL)          */
     long m_start;       /* saddr of block             */
     long m_length;      /* # bytes in block           */
     <a href="005014.html#PD">PD</a> *m_own;          /* Owner's process descriptor */
} MD;

</pre>
<p>See also: <a href="003.html">BIOS</a> &nbsp; <a href="About_the_BIOS.html#Getmpb">Getmpb</a> &nbsp; <a href="#MPB">MPB</a></p>

<h3><a name="MPB"></a>3.11.3 MPB</h3>
<pre>typedef struct
{
    <a href="#MD">MD</a> *mp_mfl;      /* Memory free list      */
    <a href="#MD">MD</a> *mp_mal;      /* Memory allocated list */
    <a href="#MD">MD</a> *mp_rover;    /* Roving ptr            */
} MPB;

</pre>
<p>See also: <a href="003.html">BIOS</a> &nbsp; <a href="About_the_BIOS.html#Getmpb">Getmpb</a></p>

<h3><a name="patternrectdata"></a>3.11.4 patternrectdata</h3>
<pre>struct patternrectdata
{
  int16_t x1, y1;
  int16_t x2, y2;
  int32_t fg_color;
  int32_t bg_color;
  int16_t mode;
  int32_t *pattern;
  int32_t *patternmask;
}
</pre>
<p>See also: <a href="003007.html#Cookie_2C_20_VDI">_VDI</a></p>

<h3><a name="PUN_INFO"></a>3.11.5 PUN_INFO</h3>
<pre>typedef struct
{
    WORD puns;               /* Number of devices               */
    BYTE pun[16];            /* Various flags                   */
    LONG part_start[16];     /* Partition starts                */
    LONG P_cookie;           /* Must be "AHDI"                  */
    LONG *P_cooptr;          /* Points to the previous element  */
    UWORD P_version;         /* Version number (>= 0x0300)      */
    UWORD P_max_sector;      /* Maximum sector size             */
    LONG  reserved[16];      /* Reserved                        */
} PUN_INFO;
</pre>
<table>
<tr><td nowrap="nowrap" valign="top">puns</td>
<td valign="top">Contains the number of hard drives found by the hard disk
driver.</td></tr>

<tr><td nowrap="nowrap" valign="top">pun</td>
<td valign="top"><table>
<tr><td nowrap="nowrap" valign="top">Bit 0..2:</td>
<td valign="top">Device number of the hard drive.</td></tr>

<tr><td nowrap="nowrap" valign="top">Bit 3:</td>
<td valign="top">With the bit set, this is a device on the SCSI port (otherwise
ACSI): Though this bit is not yet officially documented, it can be
used without reservation.</td></tr>

<tr><td nowrap="nowrap" valign="top">Bit 4:</td>
<td valign="top">Falcon IDE</td></tr>

<tr><td nowrap="nowrap" valign="top">Bit 5:</td>
<td valign="top">USB</td></tr>

<tr><td nowrap="nowrap" valign="top">Bit 6:</td>
<td valign="top">Removable media</td></tr>

<tr><td nowrap="nowrap" valign="top">Bit 7:</td>
<td valign="top"> If this bit is set, then the BIOS device is not controlled
by the the hard disk driver (applies e.g. for the two floppy disk
drives on device numbers 0 and 1).

</td></tr>
</table>

</td></tr>

<tr><td nowrap="nowrap" valign="top">part_start</td>
<td valign="top">Contains for each (supported) device number the number of the
start sector on the corresponding hard drive.</td></tr>

<tr><td nowrap="nowrap" valign="top">P_Cokkie</td>
<td valign="top">Magic value; always "AHDI"</td></tr>

<tr><td nowrap="nowrap" valign="top">P_cookptr</td>
<td valign="top">Should always point to the previous structure element.</td></tr>

<tr><td nowrap="nowrap" valign="top">P_version</td>
<td valign="top">Version number e.g. 0x0300</td></tr>

<tr><td nowrap="nowrap" valign="top">P_max_sector</td>
<td valign="top"> Describes the largest occurring block size for BIOS
sectors.

</td></tr>
</table>

<p>Example of how one obtains the address of the structure:</p>

<pre>PUN_INFO *GetPunPtr (void)
{
  PUN_INFO *P;
  int32_t oldstack;

  oldstack = <a href="00500e.html#Super">Super</a> (0L);
  P = *((PUN_INFO **)(0x516L));
  <a href="00500e.html#Super">Super</a> ((void *)oldstack);

  if (p)
    if (P->P_cookptr == &(P->P_cookie)) /* Cookie ok? */
      if (P->P_version >= 0x300)
        return P;

  return 0L;
}
</pre>
<p>See also: <a href="010008.html#XHDI">XHDI specification</a> &nbsp; <a href="003004.html#pun_ptr">pun_ptr</a></p>

<h3><a name="solidrectdata"></a>3.11.6 solidrectdata</h3>
<pre>struct solidrectdata
{
  int16_t x1, y1;
  int16_t x2, y2;
  int32_t fg_color;
  int32_t bg_color;
  int16_t mode;
}
</pre>
<p>See also: <a href="003007.html#Cookie_2C_20_VDI">_VDI</a></p>

<hr>

<a id="UDO_nav_hm_FOOT" href="index.html"><img src="udo_hm.gif" alt="Home" title="Home" border="0" width="24" height="24"></a><a id="UDO_nav_up_FOOT" href="003.html"><img src="udo_up.gif" alt="BIOS" title="BIOS" border="0" width="24" height="24"></a><a id="UDO_nav_lf_FOOT" href="00300a.html"><img src="udo_lf.gif" alt="BIOS function list" title="BIOS function list" border="0" width="24" height="24"></a><a id="UDO_nav_rg_FOOT" href="004.html"><img src="udo_rg.gif" alt="XBIOS" title="XBIOS" border="0" width="24" height="24"></a></body>
</html>
