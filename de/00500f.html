<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html lang="de">
<head>
<title>
Die Anleitung zum TOS: Verzeichnisfunktionen
</title>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Content-Language" content="de">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<meta name="Generator" content="UDO 7.04 (1296) for Linux">
</head>
<body>
<? include "/var/www/banner.php"; ?>

<a id="UDO_nav_hm_HEAD" href="index.html"><img src="udo_hm.gif" alt="Home" title="Home" border="0" width="24" height="24"></a><a id="UDO_nav_up_HEAD" href="005.html"><img src="udo_up.gif" alt="GEMDOS" title="GEMDOS" border="0" width="24" height="24"></a><a id="UDO_nav_lf_HEAD" href="00500e.html"><img src="udo_lf.gif" alt="Systemfunktionen" title="Systemfunktionen" border="0" width="24" height="24"></a><a id="UDO_nav_rg_HEAD" href="005010.html"><img src="udo_rg.gif" alt="Zeichenweise Ein-/Ausgabe" title="Zeichenweise Ein-/Ausgabe" border="0" width="24" height="24"></a>
<hr>

<h1><a name="Verzeichnisfunktionen"></a>5.15 Verzeichnisfunktionen</h1>
<table>
<tr><td nowrap="nowrap" valign="top">• <a href="#Dchroot">Dchroot</a>&nbsp;&nbsp;&nbsp;&nbsp;</td>
<td valign="top">changes the root directory for the calling process</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#Dclosedir">Dclosedir</a>&nbsp;&nbsp;</td>
<td valign="top">Schließt ein Verzeichnis.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#Dcntl">Dcntl</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
<td valign="top">Filesystem-spezifische Operation auf Datei/Verzeichnis.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#Dcreate">Dcreate</a>&nbsp;&nbsp;&nbsp;&nbsp;</td>
<td valign="top">Verzeichnis anlegen.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#Ddelete">Ddelete</a>&nbsp;&nbsp;&nbsp;&nbsp;</td>
<td valign="top">Verzeichnis löschen.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#Dfree">Dfree</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
<td valign="top">Freie und Gesamtkapazität eines Laufwerks ermitteln.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#Dgetcwd">Dgetcwd</a>&nbsp;&nbsp;&nbsp;&nbsp;</td>
<td valign="top">Verzeichnis eines Prozesses ermitteln.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#Dgetdrv">Dgetdrv</a>&nbsp;&nbsp;&nbsp;&nbsp;</td>
<td valign="top">Aktuelles Laufwerk ermitteln.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#Dgetpath">Dgetpath</a>&nbsp;&nbsp;&nbsp;</td>
<td valign="top">Aktuelles Verzeichnis ermitteln.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#Dlock">Dlock</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
<td valign="top"> BIOS-Gerät sperren bzw. wieder freigeben.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#Dopendir">Dopendir</a>&nbsp;&nbsp;&nbsp;</td>
<td valign="top"> Verzeichnis zum Lesen öffnen.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#Dpathconf">Dpathconf</a>&nbsp;&nbsp;</td>
<td valign="top"> Informationen über ein Filesystem ermitteln.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#Dreaddir">Dreaddir</a>&nbsp;&nbsp;&nbsp;</td>
<td valign="top"> Verzeichnis-Informationen lesen.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#Dreadlabel">Dreadlabel</a>&nbsp;</td>
<td valign="top"> Filesystem Label lesen.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#Drewinddir">Drewinddir</a>&nbsp;</td>
<td valign="top"> Geöffentes Verzeichnis zurücksetzen.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#Dsetdrv">Dsetdrv</a>&nbsp;&nbsp;&nbsp;&nbsp;</td>
<td valign="top"> Aktuelles Laufwerk ändern.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#Dsetpath">Dsetpath</a>&nbsp;&nbsp;&nbsp;</td>
<td valign="top"> Aktuelles Verzeichnis ändern.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#Dwritelabel">Dwritelabel</a></td>
<td valign="top"> Filesystem Label setzen.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#Dxopendir">Dxopendir</a>&nbsp;&nbsp;</td>
<td valign="top"> Verzeichnis zum Lesen öffnen.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#Dxreaddir">Dxreaddir</a>&nbsp;&nbsp;</td>
<td valign="top"> Verzeichnis-Informationen lesen, Attribute ermitteln.

</td></tr>
</table>

<p>Querverweis: <a href="005009.html">Dateifunktionen</a> &nbsp; <a href="00400d.html">XBIOS-Laufwerksfunktionen</a></p>

<h3><a name="Dchroot"></a>5.15.1 Dchroot</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»Dchroot« - changes the root directory for the calling
process</td></tr>

<tr><td nowrap="nowrap" valign="top">Gemdosnummer:</td>
<td valign="top">330 (0x014a)</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top">int32_t Dchroot( int8_t *path );</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top">The path <i>parameter</i> is a pathname of the folder that
will be the new root directory for the calling process. Directories
and files which are outside to the specified tree will be no longer
accessible.<br><br>

Dchroot does not automatically change the current directory to the
newly specified root. Also, the call needs root privileges to operate
properly. This function is used by e.g. ftpd to limit the user
privileges in accessing filesystems.</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top">Returns the <a href="005003.html#E_OK">E_OK</a> on success or a negative <a href="005.html">GEMDOS</a> error code
otherwise.</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar</td>
<td valign="top">Available as of FreeMiNT version 1.15.4</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"><a href="#Verzeichnisfunktionen">Verzeichnisfunktionen</a></td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"> <a href="#Bindings_20f_C3_BCr_20Dchroot">Binding</a> &nbsp; <a href="#Dopendir">Dopendir</a> &nbsp; <a href="#Dreaddir">Dreaddir</a> &nbsp; <a href="00b.html">MagiC</a>

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Dchroot"></a>5.15.1.1 Bindings für Dchroot</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">int32_t <a href="#Dchroot">Dchroot</a>( int8_t *path );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>pea       path             ; Offset 2
move.w    #330,-(sp)       ; Offset 0
trap      #1               ; <a href="005.html">GEMDOS</a> aufrufen
addq.l    #6,sp            ; Stack korrigieren
</pre>


</td></tr>
</table>

<h3><a name="Dclosedir"></a>5.15.2 Dclosedir</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»Dclosedir« - schließt ein Verzeichnis.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gemdosnummer:</td>
<td valign="top">299</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top">int32_t Dclosedir ( int32_t dirhandle );</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top">Die Funktion schließt das Verzeichnis mit dem Handle
<i>dirhandle</i>.</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top">Die Funktion liefert den Wert 0, falls das Verzeichnis korrekt
geschlossen werden konnte. Wenn <i>dirhandle</i> ungültig ist, wird
der Wert <a href="005003.html#EIHNDL">EIHNDL</a> zurückgegeben.</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top">Verfügbar, wenn ein 'MiNT' Cookie mit einer Versionsnummer von
mindestens 0.90 existiert und in <a href="00b.html">MagiC</a> ab Version 3.0.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"><a href="#Verzeichnisfunktionen">Verzeichnisfunktionen</a></td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"><a href="#Bindings_20f_C3_BCr_20Dclosedir">Binding</a> &nbsp; <a href="#Dopendir">Dopendir</a> &nbsp; <a href="#Dreaddir">Dreaddir</a> &nbsp; <a href="00b.html">MagiC</a>

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Dclosedir"></a>5.15.2.1 Bindings für Dclosedir</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">int32_t <a href="#Dclosedir">Dclosedir</a> ( int32_t dirhandle );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>move.l    dirhandle,-(sp)  ; Offset 2
move.w    #299,-(sp)       ; Offset 0
trap      #1               ; <a href="005.html">GEMDOS</a> aufrufen
addq.l    #6,sp            ; Stack korrigieren
</pre>


</td></tr>
</table>

<h3><a name="Dcntl"></a>5.15.3 Dcntl</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»Dcntl« - führt eine Filesystem spezifische Operation auf
einer Datei bzw. einem Verzeichnis durch.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gemdosnummer:</td>
<td valign="top">304</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top">int32_t Dcntl ( int16_t cmd, int8_t *name, int32_t arg );</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top">Die Funktion führt das Kommando <i>cmd</i> auf dem File bzw.
Verzeichnis <i>name</i> aus. Einzelheiten sind vom Filesystem
abhängig, auf das sich <i>name</i> bezieht. Die Bedeutung des
Parameters <i>arg</i> ist wiederum von <i>cmd</i> abhängig.<br><br>

Standardmäßig wird der Dcntl-Aufruf von den Filesystemen U:\\
und U:\DEV unterstützt.<br><br>

<b>Das Unified-Filesystem U:\ kennt die folgenden Kommandos:</b><table>
<tr><td nowrap="nowrap" valign="top">Kommando</td>
<td valign="top">Beschreibung<a name="FS_INSTALL"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">FS_INSTALL (0xf001)</td>
<td valign="top">installiert ein neues Filesystem<table>
<tr><td nowrap="nowrap" valign="top">name:</td>
<td valign="top">U:\</td></tr>

<tr><td nowrap="nowrap" valign="top">arg:</td>
<td valign="top">Zeiger auf <a href="00b015.html#fs_descr">fs_descr</a> Struktur

</td></tr>
</table>

<a name="FS_MOUNT"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">FS_MOUNT (0xf002)</td>
<td valign="top">Bindet ein bereits existierendes Filesystem in das
Unified-System U:\ ein.<table>
<tr><td nowrap="nowrap" valign="top">name:</td>
<td valign="top">Name unter dem auf das Filesystem zugegriffen werden kann.</td></tr>

<tr><td nowrap="nowrap" valign="top">arg:</td>
<td valign="top">Zeiger auf fs_descr Struktur

</td></tr>
</table>

<a name="FS_UNMOUNT"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">FS_UNMOUNT (0xf003)</td>
<td valign="top">entfernt ein per FS_MOUNT eingehängtes System.<table>
<tr><td nowrap="nowrap" valign="top">name:</td>
<td valign="top">Name unter dem das Filesystem eingebunden wurde.</td></tr>

<tr><td nowrap="nowrap" valign="top">arg:</td>
<td valign="top">Zeiger auf <a href="00b015.html#fs_descr">fs_descr</a> Struktur

</td></tr>
</table>

<a name="FS_UNINSTALL"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">FS_UNINSTALL (0xf004)</td>
<td valign="top">Entfernt ein Filesystem vollständig aus dem Kernel. Dieser
Befehl ist nur erlaubt, wenn keine weiteren Verweise auf das
Filesystem existieren, also beispielsweise etwaige Mounts rückgängig
gemacht wurden.<table>
<tr><td nowrap="nowrap" valign="top">name:</td>
<td valign="top">U:\\</td></tr>

<tr><td nowrap="nowrap" valign="top">arg:</td>
<td valign="top">Zeiger auf fs_descr Struktur

</td></tr>
</table>

</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="005009.html#FUTIME">FUTIME</a> (0x4603)</td>
<td valign="top">Ist das Pendant zur gleichnamigen <a href="005009.html#Fcntl">Fcntl</a>()-Funktion. Sie wird
von MiNT sowie vom DOS-XFS in <a href="00b.html">MagiC</a> unterstützt. Als Parameter wird
ein Zeiger auf eine <a href="005014.html#mutimbuf">mutimbuf</a>-Struktur übergeben.<a name="KER_GETINFO"></a>
<a name="MX_KER_GETINFO"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">KER_GETINFO (0x0100)</td>
<td valign="top">Ermittelt einen Zeiger auf die Kernelfunktionen von MagiC.
Bei den Parametern <i>name</i> und <i>arg</i> muss es sich um
NULL-Werte handeln. Zurückgeliefert wird ein Zeiger auf eine
<a href="00b015.html#MX_KERNEL">MX_KERNEL</a>-Struktur. (*)<br><br>

Ab MagiC 6: MX_KER_GETINFO (0x6d00) (1)<a name="KER_DOSLIMITS"></a>
<a name="MX_KER_DOSLIMITS"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">KER_DOSLIMITS (0x0101)</td>
<td valign="top">Fordert den Kernel von MagiC auf, die Limits für
FAT-Dateisysteme zu ermitteln. Die Parameter <i>name</i> und
<i>arg</i> müssen auf NULL gesetzt werden. Zurückgeliefert wird ein
Zeiger auf einen Zeiger auf eine <a href="00b015.html#MX_DOSLIMITS">MX_DOSLIMITS</a> Struktur; dieser kann
daher auf eine eigene Struktur umgebogen werden, falls ein neuer
Treiber installiert wird. Dieser Opcode wird normalerweise nur von
Festplattentreibern (wie dem HDDRIVER) verwendet. (*)<br><br>

Ab MagiC 6: MX_KER_DOSLIMITS (0x6d01) (1)<a name="KER_INTMAVAIL"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">KER_INTMAVAIL (0x102)</td>
<td valign="top">&nbsp;<a name="KER_INTGARBC"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">KER_INTGARBC (0x103)</td>
<td valign="top">Diese Funktionen existierten vor der Version 4.01 von MagiC,
und wurden auf <a href="00500e.html#Sconfig">Sconfig</a>-Aufrufe umgesetzt, um Konflikte mit Treibern zu
vermeiden, die Probleme mit unbekannten Opcodes besitzen (*).<a name="KER_DRVSTAT"></a>
<a name="MX_KER_DRVSTAT"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">KER_DRVSTAT (0x0104)</td>
<td valign="top">Ermittelt einfache Informationen über ein Laufwerk. Es gilt:<table>
<tr><td nowrap="nowrap" valign="top">name:</td>
<td valign="top">wird ignoriert</td></tr>

<tr><td nowrap="nowrap" valign="top">arg:</td>
<td valign="top">Zeiger auf zwei int16_ts.

</td></tr>
</table>

<br><br>

Das erste int16_t muss dabei eine Null enthalten, in das zweite
wird eine Laufwerksnummer von 0..25 (A..Z) geschrieben. Die möglichen
Rückgabewerte für diesen Opcode lauten:<table>
<tr><td nowrap="nowrap" valign="top"><a href="005003.html#EDRIVE">EDRIVE</a> :</td>
<td valign="top">ungültige Laufwerksnummer</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="005003.html#ELOCKED">ELOCKED</a> :</td>
<td valign="top">Laufwerk z.Zt. gesperrt

</td></tr>
</table>

<br><br>

Ein Wert von 0 bzw. >0 zeigt an, daß das Laufwerk z.Zt. gemounted
bzw. nicht gemounted ist. Dieser Opcode steht erst ab der
MagiC-Version vom 09.09.95 zur Verfügung (*).<br><br>

Ab MagiC 6: MX_KER_DRVSTAT (0x6d04) (1)<a name="KER_XFSNAME"></a>
<a name="MX_KER_XFSNAME"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">KER_XFSNAME (0x0105)</td>
<td valign="top">Ermittelt den Namen des Treibers, welcher für ein bestimmtes
Verzeichnis zuständig ist.<table>
<tr><td nowrap="nowrap" valign="top">name:</td>
<td valign="top">Pfadname (kein Dateiname!)</td></tr>

<tr><td nowrap="nowrap" valign="top">arg:</td>
<td valign="top">Zeiger auf einen mindestens 9 Zeichen großen Puffer, der an
einer geraden Adresse liegen muss.

</td></tr>
</table>

<br><br>

Ein Rückgabewert < 0 kennzeichnet einen Fehler; ansonsten wird im
angegebenen Puffer der Name des Treibers abgelegt; z.Zt. sind folgende
Treibernamen bekannt:<table>
<tr><td nowrap="nowrap" valign="top">(a) "DOS_XFS":</td>
<td valign="top">altes DOS-XFS</td></tr>

<tr><td nowrap="nowrap" valign="top">(b) "VDOS_XFS":</td>
<td valign="top">DOS-XFS mit VFAT</td></tr>

<tr><td nowrap="nowrap" valign="top">(c) "MMAC_HFS":</td>
<td valign="top">MagiCMac-HFS

</td></tr>
</table>

<br><br>

Dieser Opcode steht erst ab der <a href="00b.html">MagiC</a>-Version vom 15.06.1996 zur
Verfügung (*).<br><br>

Ab MagiC 6: MX_KER_XFSNAME (0x6d05) (1)<a name="KER_INSTXFS"></a>
<a name="MX_KER_INSTXFS"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">KER_INSTXFS (0x0200)</td>
<td valign="top">Fordert den Kernel von MagiC auf, ein XFS zu installieren.
(*)<table>
<tr><td nowrap="nowrap" valign="top">name:</td>
<td valign="top">NULL-Zeiger</td></tr>

<tr><td nowrap="nowrap" valign="top">arg:</td>
<td valign="top">einzubindender Treiber

</td></tr>
</table>

<br><br>

Ab MagiC 6: MX_KER_INSTXFS (0x6d02) (1)<a name="KER_SETWBACK"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">KER_SETWBACK (0x0300)</td>
<td valign="top">Fordert den Kernel von MagiC auf, den WriteBack zu
konfigurieren. Ab MagiC-Version 4.01 wurde dieser Opcode auf einen
<a href="00500e.html#Sconfig">Sconfig</a>-Aufruf umgesetzt, um Konflikte mit Treibern zu vermeiden, die
Probleme mit unbekannten Opcodes besitzen (*).<a name="DFS_GETINFO"></a>
<a name="MX_DFS_GETINFO"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">DFS_GETINFO (0x1100)</td>
<td valign="top">Ermittelt einen Zeiger auf die DOS_XFS-Funktionen von MagiC.
Bei den Parametern <i>name</i> und <i>arg</i> muss es sich um
NULL-Werte handeln. Zurückgeliefert wird ein Zeiger auf eine
???-Struktur. (*)<br><br>

Ab MagiC 6: MX_DFS_GETINFO (0x6d40) (1)<a name="DFS_INSTDFS"></a>
<a name="MX_DFS_INSTDFS"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">DFS_INSTDFS (0x1200)</td>
<td valign="top">Installiert ein DFS unter <a href="00b.html">MagiC</a> (*).<table>
<tr><td nowrap="nowrap" valign="top">name:</td>
<td valign="top">NULL-Zeiger</td></tr>

<tr><td nowrap="nowrap" valign="top">arg:</td>
<td valign="top">einzubindender Treiber

</td></tr>
</table>

</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="005009.html#CDROMEJECT">CDROMEJECT</a> (0x4309)</td>
<td valign="top">Übernimmt das Auswerfen von Medien.<table>
<tr><td nowrap="nowrap" valign="top">name:</td>
<td valign="top">Pfad des auszuwerf. Mediums</td></tr>

<tr><td nowrap="nowrap" valign="top">arg:</td>
<td valign="top">NULL

</td></tr>
</table>

<br><br>

Die Auswurffunktion wird für alle Laufwerke unterstützt, die
über einen <a href="010008.html#XHDI">XHDI</a>-kompatiblen Treiber angesprochen werden, sowie für
Macintosh Volumes (unter MagiCMac).<br><br>

Ab MagiC 6: MX_DFS_INSTDFS (0x6d41) (1)<a name="VFAT_CNFDFLN"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">VFAT_CNFDFLN (0x5600)</td>
<td valign="top">Konfiguriert ein VFAT-Dateisystem.<table>
<tr><td nowrap="nowrap" valign="top">name:</td>
<td valign="top">U:\\</td></tr>

<tr><td nowrap="nowrap" valign="top">arg:</td>
<td valign="top">Bitvektor der festlegt, bei welchen Laufwerken lange Dateinamen
zugelassen werden.

</td></tr>
</table>

<br><br>

Die Einstellung wird erst beim mounten eines Dateisystems aktiv,
daher können bereits gemountete Dateisysteme mit diesem Befehl
<i>nicht</i> beeinflußt werden. Dieser Opcode steht erst ab der
MagiC-Version vom 02.01.96 zur Verfügung. (*).<a name="VFAT_CNFLN"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">VFAT_CNFLN (0x5601)</td>
<td valign="top">Dient der Konfiguration eines VFAT-Dateisystems. Genauer: Legt
fest, ob ein gemountetes Laufwerk lange Dateinamen unterstützt, oder
nicht. Mit diesem Opcode kann also der per VFAT_CNFDFLN festgelegte
Defaultwert <i>überladen</i> werden. Damit die Umstellung für den
Benutzer sichtbar wird, sollte eine <a href="008007.html#SH_WDRAW">SH_WDRAW</a>-Nachricht an die
System-Shell geschickt werden. Dieser Opcode steht erst ab der
<a href="00b.html">MagiC</a>-Version vom 02.01.96 zur Verfügung (*).<a name="PROC_CREATE"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">PROC_CREATE (0xcc00)</td>
<td valign="top">Diese Funktion ist in MagiC für zukünftige Zwecke
reserviert (*). Sie wird ab <a href="00b.html">MagiC</a> 6 nicht mehr verwendet.

</td></tr>
</table>

<br><br>

<b>Das Filesystem U:\DEV kennt folgende Kommandos:</b><table>
<tr><td nowrap="nowrap" valign="top">Kommando</td>
<td valign="top">Beschreibung</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;</td>
<td valign="top">&nbsp;<a name="DEV_INSTALL"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">DEV_INSTALL (0xde02)</td>
<td valign="top">installiert einen neuen Treiber für ein Gerät.<table>
<tr><td nowrap="nowrap" valign="top">name:</td>
<td valign="top">vollständiger Pfadname des Treibers</td></tr>

<tr><td nowrap="nowrap" valign="top">arg:</td>
<td valign="top">Zeiger auf <a href="00b015.html#dev_descr">dev_descr</a>-Struktur

</td></tr>
</table>

<br><br>

Auf das so installierte Gerät, darf nur über <a href="005.html">GEMDOS</a> Operationen
zugegriffen werden.<a name="DEV_M_INSTALL"></a>
<a name="MX_DEV_INSTALL"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">DEV_M_INSTALL (0xcd00)</td>
<td valign="top">entspricht DEV_INSTALL und muß aufgrund des inkompatiblen
Treiberformates zu MultiTOS in MagiC benutzt werden. (*)<table>
<tr><td nowrap="nowrap" valign="top">name:</td>
<td valign="top">vollst. Pfadname des Treibers</td></tr>

<tr><td nowrap="nowrap" valign="top">arg:</td>
<td valign="top">Zeiger auf MX_DDEV-Struktur

</td></tr>
</table>

<br><br>

Ab MagiC 6: MX_DEV_INSTALL (0x6d20) (1)<a name="DEV_NEWTTY"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">DEV_NEWTTY (0xde00)</td>
<td valign="top">installiert Treiber für ein neues <a href="003.html">BIOS</a> Terminal<table>
<tr><td nowrap="nowrap" valign="top">name:</td>
<td valign="top">Name des Terminals (in der Form 'U:\DEV\DEVNAME')</td></tr>

<tr><td nowrap="nowrap" valign="top">arg:</td>
<td valign="top">BIOS Gerätenummer des Terminals

</td></tr>
</table>

<br><br>

Das BIOSmuß per <a href="004010.html#Bconmap">Bconmap</a> über das Gerät informiert worden sein,
anderenfalls wird jeder Versuch auf das Gerät zuzugreifen mit <a href="003006.html#EUNDEV">EUNDEV</a>
bestraft.<a name="DEV_NEWBIOS"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">DEV_NEWBIOS (0xde01)</td>
<td valign="top">installiert einen Treiber für ein neues <a href="003.html">BIOS</a> nicht-Terminal
Gerät.<table>
<tr><td nowrap="nowrap" valign="top">name:</td>
<td valign="top">vollständiger Name des Geräts</td></tr>

<tr><td nowrap="nowrap" valign="top">arg:</td>
<td valign="top">zugehörige BIOS Gerätenummer

</td></tr>
</table>

<br><br>

Das BIOSmuß per <a href="004010.html#Bconmap">Bconmap</a> über das Gerät informiert worden sein,
anderenfalls wird jeder Versuch auf das Gerät zuzugreifen mit <a href="003006.html#EUNDEV">EUNDEV</a>
bestraft.

</td></tr>
</table>

<br><br>

<b>Hinweis:</b> Die mit (*) gekennzeichneten Opcodes stehen dabei
nur unter <a href="00b.html">MagiC</a>, alle anderen nur unter MiNT bzw. MultiTOS zur
Verfügung. Ausnahmen: Die Opcodes <a href="005009.html#FUTIME">FUTIME</a> und <a href="005009.html#CDROMEJECT">CDROMEJECT</a> stehen sowohl
unter MiNT/MultiTOS als auch unter <a href="00b.html">MagiC</a> zur Verfügung.<br><br>

(1): Leider gab es Kollisionen zwischen <a href="00b.html">MagiC</a> und dem Minix-XFS
für MiNT. Daher enthält MagiC ab der Version 6 neue Codes, die
alten werden aber noch unterstützt. Die neuen Codes haben ein 0x6d im
oberen Word, diese Kennung ist für <a href="00b.html">MagiC</a> reserviert.</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top">Der Rückgabewert ist abhängig von der gewünschten Operation
und dem zugrunde liegenden Filesystem. Bei einem Wert >= 0 ist alles
erfolgreich verlaufen. Eine Ausnahme ist der Wert bei DEV_INSTALL,
welcher entweder auf eine Informationsstruktur des Kernels zeigt, oder
aber den Wert 0 besitzt.<br><br>

Bei einem ungültigen Opcode wird <a href="005003.html#EINVFN">EINVFN</a> zurückgeliefert.</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top">Verfügbar, wenn ein 'MiNT' Cookie mit einer Versionsnummer von
mindestens 0.90 existiert und in <a href="00b.html">MagiC</a> ab Version 3.0.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"><a href="#Verzeichnisfunktionen">Verzeichnisfunktionen</a></td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"><a href="#Bindings_20f_C3_BCr_20Dcntl">Binding</a> &nbsp; <a href="00b015.html">XFS-Konzept in MagiC</a> &nbsp; <a href="004010.html#Bconmap">Bconmap</a> &nbsp; <a href="005009.html#Fcntl">Fcntl</a> &nbsp; <a href="00b.html">MagiC</a> &nbsp; <a href="00400d.html#Metaioctl">Metaioctl</a>

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Dcntl"></a>5.15.3.1 Bindings für Dcntl</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">int32_t <a href="#Dcntl">Dcntl</a> ( int16_t cmd, int8_t *name, int32_t arg );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>move.l    arg,-(sp)    ; Offset 8
pea       name         ; Offset 4
move.w    cmd,-(sp)    ; Offset 2
move.w    #304,-(sp)   ; Offset 0
trap      #1           ; <a href="005.html">GEMDOS</a> aufrufen
lea       $C(sp),sp    ; Stack korrigieren
</pre>


</td></tr>
</table>

<h3><a name="Dcreate"></a>5.15.4 Dcreate</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»create directory« - Verzeichnis anlegen.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gemdosnummer:</td>
<td valign="top">57</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top">int32_t Dcreate ( CONST int8_t *path );</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top">Die <a href="005.html">GEMDOS</a>-Routine Dcreate legt ein Verzeichnis mit dem
Pfadnamen <i>path</i> an, der mit dem ASCII-Zeichen 0 abgeschlossen
sein muss.<br><br>

<b>Hinweis:</b> Aufgrund mangelhafter Fehlerbehandlungen in
GEMDOS-Versionen < 0.15 konnte u.U. das Dateisystem beschädigt
werden. Ferner wurde nicht überprüft, ob eine Datei des angegebenen
Namens bereits existiert.<br><br>

Ab <a href="00b.html">MagiC</a>-3 wird der Aufruf vom Kernel weitergegeben als
<a href="00b015.html#xfs_dcreate">xfs_dcreate</a> mit Erstellmodus <a href="005009.html#Fxattr">Fxattr</a> %0100000111101101 (d.h. 'directory
file' mit einer Zugriffsberechtigung RWXRwXRwX). Das XFS sollte keine
gleichnamigen Dateien oder Unterverzeichnisse löschen, sondern in
diesem Fall den Fehlercode <a href="005003.html#EACCDN">EACCDN</a> liefern. Ungültige Dateinamen wie
"." oder ".." müssen auch vom XFS abgefangen werden.</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top">Die Funktion liefert folgende Resultate:<table>
<tr><td nowrap="nowrap" valign="top">Wert</td>
<td valign="top">Bedeutung</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;</td>
<td valign="top">&nbsp;</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="005003.html#E_OK">E_OK</a></td>
<td valign="top">kein Fehler aufgetreten</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="005003.html#EPTHNF">EPTHNF</a></td>
<td valign="top">Verzeichnis nicht gefunden</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="005003.html#EACCDN">EACCDN</a></td>
<td valign="top">Zugriff verweigert

</td></tr>
</table>

</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top">Alle GEMDOS Versionen.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"><a href="#Verzeichnisfunktionen">Verzeichnisfunktionen</a></td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"><a href="#Bindings_20f_C3_BCr_20Dcreate">Binding</a> &nbsp; <a href="#Ddelete">Ddelete</a> &nbsp; <a href="010001.html">ASCII-Tabelle</a>

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Dcreate"></a>5.15.4.1 Bindings für Dcreate</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">int32_t <a href="#Dcreate">Dcreate</a> ( CONST int8_t *path );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>pea       path         ; Offset 2
move.w    #57,-(sp)    ; Offset 0
trap      #1           ; <a href="005.html">GEMDOS</a> aufrufen
addq.l    #6,sp        ; Stack korrigieren
</pre>
</td></tr>

<tr><td nowrap="nowrap" valign="top">GFA-Basic</td>
<td valign="top">Fehler%=Gemdos(&H39,L:path%)

</td></tr>
</table>

<h3><a name="Ddelete"></a>5.15.5 Ddelete</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»delete directory« - Verzeichnis löschen.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gemdosnummer:</td>
<td valign="top">58</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top">int32_t Ddelete ( CONST int8_t *path );</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top">Die <a href="005.html">GEMDOS</a>-Routine Ddelete löscht ein Verzeichnis mit dem
Pfadnamen <i>path</i>, das keine weiteren Dateien oder
Unterverzeichnisse enthalten darf. Der String <i>path</i> muß mit
dem ASCII-Zeichen 0 abgeschlossen sein.<br><br>

<b>Hinweis:</b> In GEMDOS-Versionen < 0.15 funktionierte ein
Aufruf von <a href="#Dcreate">Dcreate</a> mit unmittelbar folgendem Ddelete nicht - erst ein
weiteres Ddelete brachte das gewünschte Resultat.<br><br>

In <a href="00b.html">MagiC</a> testet der Kernel vorher, ob das Verzeichnis ein
aktueller Pfad ist, und liefert ggfs. eine Fehlermeldung zurück. Nach
Möglichkeit sollten nur leere Verzeichnisse gelöscht werden; dies
ist jedoch Sache des XFS. Ab MagiC-Version 4.01 können mit Hilfe
dieser Funktion auch symbolische Links gelöscht werden; in älteren
Versionen wurde stets das Verzeichnis gelöscht, auf welches der Link
zeigte.</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top">Die Funktion liefert folgende Resultate:<table>
<tr><td nowrap="nowrap" valign="top">Wert</td>
<td valign="top">Bedeutung</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;</td>
<td valign="top">&nbsp;</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="005003.html#E_OK">E_OK</a></td>
<td valign="top">kein Fehler aufgetreten</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="005003.html#EPTHNF">EPTHNF</a></td>
<td valign="top">Verzeichnis nicht gefunden</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="005003.html#EACCDN">EACCDN</a></td>
<td valign="top">Zugriff verweigert</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="005003.html#EINTRN">EINTRN</a></td>
<td valign="top">interner Fehler des GEMDOS

</td></tr>
</table>

</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top">Alle GEMDOS Versionen.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"><a href="#Verzeichnisfunktionen">Verzeichnisfunktionen</a></td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"><a href="#Bindings_20f_C3_BCr_20Ddelete">Binding</a> &nbsp; <a href="#Dcreate">Dcreate</a> &nbsp; <a href="00b015.html">XFS-Konzept in MagiC</a>

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Ddelete"></a>5.15.5.1 Bindings für Ddelete</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">int32_t <a href="#Ddelete">Ddelete</a> ( CONST int8_t *path );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>pea       path         ; Offset 2
move.w    #58,-(sp)    ; Offset 0
trap      #1           ; <a href="005.html">GEMDOS</a> aufrufen
addq.l    #6,sp        ; Stack korrigieren
</pre>
</td></tr>

<tr><td nowrap="nowrap" valign="top">GFA-Basic</td>
<td valign="top">Fehler%=Gemdos(&H3A,L:path%)

</td></tr>
</table>

<h3><a name="Dfree"></a>5.15.6 Dfree</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»free disk space« - ermittelt die Kapazitätsauslastung eines
Laufwerks.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gemdosnummer:</td>
<td valign="top">54</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top">int16_t Dfree ( <a href="005014.html#DISKINFO">DISKINFO</a> *buf, int16_t driveno );</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top">Die <a href="005.html">GEMDOS</a>-Routine Dfree ermittelt die Kapazität und Belegung
eines Laufwerks. Es gilt:<table>
<tr><td nowrap="nowrap" valign="top">Parameter</td>
<td valign="top">Bedeutung</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;</td>
<td valign="top">&nbsp;</td></tr>

<tr><td nowrap="nowrap" valign="top">buf</td>
<td valign="top">Adresse des Informations-Puffers</td></tr>

<tr><td nowrap="nowrap" valign="top">driveno</td>
<td valign="top"><table>
<tr><td nowrap="nowrap" valign="top">0 =</td>
<td valign="top">aktuelles Laufwerk</td></tr>

<tr><td nowrap="nowrap" valign="top">1 =</td>
<td valign="top">Laufwerk-A</td></tr>

<tr><td nowrap="nowrap" valign="top">2 =</td>
<td valign="top">Laufwerk-B (usw.)
</td></tr>
</table>


</td></tr>
</table>

<br><br>

<b>Hinweis:</b> In GEMDOS-Versionen < 0.15 ist diese Funktion
unglaublich langsam.<br><br>

Auf das Verzeichnis U:\PROC angewandt, liefert diese Funktion ab
<a href="00b.html">MagiC</a> 3 die minimale, tatsächliche Blocklänge (als Sektoren pro
Cluster). Zur Zeit wird der Speicher wortweise belegt, d.h. die
'Sektorgröße' ist 1 int8_t, und die Clustergröße beträgt 2
Sektoren (also 2 int8_ts).</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top">Die Funktion liefert bei korrekter Ausführung eine 0, und eine
negative Zahl, wenn es zu einem Fehler kam.</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top">Alle GEMDOS Versionen.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"><a href="#Verzeichnisfunktionen">Verzeichnisfunktionen</a></td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"><a href="#Bindings_20f_C3_BCr_20Dfree">Binding</a> &nbsp; <a href="005009.html#Fdelete">Fdelete</a>

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Dfree"></a>5.15.6.1 Bindings für Dfree</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">int16_t <a href="#Dfree">Dfree</a> ( <a href="005014.html#DISKINFO">DISKINFO</a> *buf, int16_t driveno );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>move.w    driveno,-(sp)  ; Offset 6
pea       buf            ; Offset 2
move.w    #54,-(sp)      ; Offset 0
trap      #1             ; <a href="005.html">GEMDOS</a> aufrufen
addq.l    #8,sp          ; Stack korrigieren
</pre>
</td></tr>

<tr><td nowrap="nowrap" valign="top">GFA-Basic</td>
<td valign="top">Fehler%=Gemdos(&H36,L:buf%,W:driveno%)

</td></tr>
</table>

<h3><a name="Dgetcwd"></a>5.15.7 Dgetcwd</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»Dgetcwd« - bestimmt das aktuelle Verzeichnis eines
Prozesses.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gemdosnummer:</td>
<td valign="top">315</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top">int32_t Dgetcwd ( int8_t *path, int16_t drv, int16_t size );</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top">Es wird das aktuelle Arbeitsverzeichnis des aktiven Prozesses
auf Laufwerk <i>drv</i> geliefert. Der Parameter <i>size</i> gibt
die Größe des den Namen aufnehmenden Puffers an.</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top"><i>path</i>: Verzeichnis des aktuellen Prozesses.<br><br>

Der Rückgabewert der Funktion ist entweder 0 (alles ok), <a href="005003.html#ERANGE">ERANGE</a>
(die Größe des Puffers reicht nicht aus, um die exakte Beschreibung
des Verzeichnisses aufzunehmen), oder <a href="005003.html#EDRIVE">EDRIVE</a> (kein gültiges GEMDOS
Laufwerk).</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top">Verfügbar, wenn ein 'MiNT' Cookie mit einer Versionsnummer von
mindestens 0.96 existiert und in <a href="00b.html">MagiC</a> ab Version 3.0.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"><a href="#Verzeichnisfunktionen">Verzeichnisfunktionen</a></td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"><a href="#Bindings_20f_C3_BCr_20Dgetcwd">Binding</a> &nbsp; <a href="#Dgetpath">Dgetpath</a>

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Dgetcwd"></a>5.15.7.1 Bindings für Dgetcwd</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">int32_t <a href="#Dgetcwd">Dgetcwd</a> ( int8_t *path, int16_t drv, int16_t size );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>move.w    size,-(sp)   ; Offset 8
move.w    drv,-(sp)    ; Offset 6
pea       path         ; Offset 2
move.w    #315,-(sp)   ; Offset 0
trap      #1           ; <a href="005.html">GEMDOS</a> aufrufen
lea       $A(sp),sp    ; Stack korrigieren
</pre>


</td></tr>
</table>

<h3><a name="Dgetdrv"></a>5.15.8 Dgetdrv</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»disk get drive« - ermittelt das aktuelle Laufwerk.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gemdosnummer:</td>
<td valign="top">25</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top">int16_t Dgetdrv ( VOID );</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top">Die <a href="005.html">GEMDOS</a>-Routine Dgetdrv ermittelt das aktuelle Laufwerk.</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top">Die Funktion liefert als Ergebnis eine Zahl, die wie folgt
codiert ist:<table>
<tr><td nowrap="nowrap" valign="top">Wert</td>
<td valign="top">Bedeutung</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;</td>
<td valign="top">&nbsp;</td></tr>

<tr><td nowrap="nowrap" valign="top">0</td>
<td valign="top">Laufwerk-A</td></tr>

<tr><td nowrap="nowrap" valign="top">1</td>
<td valign="top">Laufwerk-B</td></tr>

<tr><td nowrap="nowrap" valign="top">2</td>
<td valign="top">Laufwerk-C</td></tr>

<tr><td nowrap="nowrap" valign="top">3</td>
<td valign="top">Laufwerk-D (usw.)

</td></tr>
</table>

<br><br>

<b>Hinweis:</b> Ab <a href="00b.html">MagiC</a> 3 sind Laufwerke von A bis Z, d.h. Werte
von 0 bis 25 zulässig.</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top">Alle GEMDOS Versionen.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"><a href="#Verzeichnisfunktionen">Verzeichnisfunktionen</a></td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"><a href="#Bindings_20f_C3_BCr_20Dgetdrv">Binding</a> &nbsp; <a href="#Dsetdrv">Dsetdrv</a> &nbsp; <a href="003004.html#_drvbits">_drvbits</a>

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Dgetdrv"></a>5.15.8.1 Bindings für Dgetdrv</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">int16_t <a href="#Dgetdrv">Dgetdrv</a> ( VOID );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>move.w    #25,-(sp)    ; Offset 0
trap      #1           ; <a href="005.html">GEMDOS</a> aufrufen
addq.l    #2,sp        ; Stack korrigieren
</pre>
</td></tr>

<tr><td nowrap="nowrap" valign="top">GFA-Basic</td>
<td valign="top">Fehler%=Gemdos(&H19)

</td></tr>
</table>

<h3><a name="Dgetpath"></a>5.15.9 Dgetpath</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»get path« - aktuelles Verzeichnis ermitteln.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gemdosnummer:</td>
<td valign="top">71</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top">int16_t Dgetpath ( int8_t *path, int16_t driveno );</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top">Die <a href="005.html">GEMDOS</a>-Routine Dgetpath ermittelt das aktuelle Verzeichnis
auf dem Laufwerk <i>driveno</i>. Die Bezeichnungen der Laufwerke
werden im Parameter <i>driveno</i> wie folgt codiert:<table>
<tr><td nowrap="nowrap" valign="top">driveno</td>
<td valign="top">Bedeutung</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;</td>
<td valign="top">&nbsp;</td></tr>

<tr><td nowrap="nowrap" valign="top">0</td>
<td valign="top">aktuelles Laufwerk</td></tr>

<tr><td nowrap="nowrap" valign="top">1</td>
<td valign="top">Laufwerk-A</td></tr>

<tr><td nowrap="nowrap" valign="top">2</td>
<td valign="top">Laufwerk-B</td></tr>

<tr><td nowrap="nowrap" valign="top">3</td>
<td valign="top">Laufwerk-C (usw.)

</td></tr>
</table>

<br><br>

Der Pfad wird im Puffer <i>path</i> als String abgelegt. Da die
maximale Länge eines Pfades im GEMDOS nicht begrenzt, und nur bei
Existenz der Funktion <a href="#Dpathconf">Dpathconf</a> ermittelt werden kann, sollte der
aufnehmende Puffer ausreichend Platz bieten (256 Bytes dürften wohl
ausreichend sein).</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top">Die Funktion liefert folgende Resultate:<br><br>


<div align="left">
<table border="0">
<tr>
  <td align="left" valign="top"><a href="005003.html#E_OK">E_OK</a></td>
  <td align="left" valign="top">:</td>
  <td align="left" valign="top">kein Fehler aufgetreten</td>
</tr>
<tr>
  <td align="left" valign="top"><a href="005003.html#EDRIVE">EDRIVE</a></td>
  <td align="left" valign="top">:</td>
  <td align="left" valign="top">falsche Laufwerksnummer</td>
</tr>
</table>
</div>

</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top">Alle <a href="005.html">GEMDOS</a> Versionen.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"><a href="#Verzeichnisfunktionen">Verzeichnisfunktionen</a></td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"><a href="#Bindings_20f_C3_BCr_20Dgetpath">Binding</a> &nbsp; <a href="#Dsetpath">Dsetpath</a>

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Dgetpath"></a>5.15.9.1 Bindings für Dgetpath</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">int16_t <a href="#Dgetpath">Dgetpath</a> ( int8_t *path, int16_t driveno );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>move.w    driveno,-(sp)  ; Offset 6
pea       path           ; Offset 2
move.w    #71,-(sp)      ; Offset 0
trap      #1             ; <a href="005.html">GEMDOS</a> aufrufen
addq.l    #8,sp          ; Stack korrigieren
</pre>
</td></tr>

<tr><td nowrap="nowrap" valign="top">GFA-Basic</td>
<td valign="top">Fehler%=Gemdos(&H47,L;path%,W:driveno%)

</td></tr>
</table>

<h3><a name="Dlock"></a>5.15.10 Dlock</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»Dlock« - sperrt ein <a href="003.html">BIOS</a> Gerät bzw. gibt es wieder frei.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gemdosnummer:</td>
<td valign="top">309</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top">int32_t Dlock ( int16_t mode, int16_t drv );</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top">Die Funktion erlaubt es, das <a href="003.html">BIOS</a>-Gerät <i>drv</i> zu
sperren, bzw. wieder freizugeben. Auf einem gelockten Laufwerk sind
keine <a href="005.html">GEMDOS</a> File-Operationen zugelassen; <a href="About_the_BIOS.html#Rwabs">Rwabs</a> ist nur für den
sperrenden Prozess erlaubt.<br><br>

Der Sinn und Zweck der Funktion besteht darin, daß Low-Level
Programme (etwa zum Formatieren) (X)BIOS Funktionen ausführen
können, während das Gerät für normale Dateizugriffe gesperrt
bleibt.<br><br>


<div align="left">
<table border="0">
<tr>
  <td align="right" valign="top">Bit 0 von mode = 1:</td>
  <td align="left" valign="top">Gerät sperren</td>
</tr>
<tr>
  <td align="right" valign="top">= 0:</td>
  <td align="left" valign="top">Gerät freigeben</td>
</tr>
</table>
</div>

<br><br>

Wird ein Prozeß beendet der noch eine Sperre auf einem Gerät
hält, so wird diese Sperre aufgehoben.<br><br>

Bit 1 von <i>mode</i> zeigt an, welche Rückgabewerte gewünscht
sind. Ist dieses Bit gesetzt, und das entsprechende Gerät bereits von
einem anderen Prozeß gesperrt (oder hat ein anderer Prozeß Files auf
diesem Gerät geöffnet), dann wird dessen Prozeß-ID
zurückgeliefert. Dies erlaubt sinnvollere Fehlermeldungen an den
Benutzer, da nun mitgeteilt werden kann, welcher Prozeß das Gerät
benutzt, wenn das Sperren fehlschlagen sollte.<br><br>

Alle anderen Bits von <i>mode</i> sind reserviert und müssen auf
0 gesetzt werden.<br><br>

Ein Sperren eines Gerätes mit unmittelbar folgendem Freigeben
desselben, ist einem Medienwechsel sehr ähnlich. Zu beachten ist
lediglich, daß nicht gesperrt werden kann, wenn auf dem angegebenen
Gerät noch Dateien geöffnet sind.<br><br>

<b>Hinweis für MagiC:</b> Vor Sperren des Laufwerks werden,
falls ein Dateisystem für das Laufwerk existiert, die Caches über
den Vektor <a href="00b015.html#xfs_sync">xfs_sync</a> zurückgeschrieben. Dann stellt der Kernel über
<a href="00b015.html#xfs_drv_close">xfs_drv_close</a> eine Anfrage, ob das Laufwerk gesperrt werden kann. Wenn
ja, gibt das XFS seine Strukturen frei und signalisiert dann dem
Kernel, daß auch er seine Strukturen für das Laufwerk freigeben und
die Sperrung durchführen kann.</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top">Die Funktion kann die folgenden Werte zurückliefern:<table>
<tr><td nowrap="nowrap" valign="top"><a href="005003.html#E_OK">E_OK</a> :</td>
<td valign="top">kein Fehler aufgetreten.</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="005003.html#EACCDN">EACCDN</a> :</td>
<td valign="top">Gerät konnte nicht gesperrt werden, da offene Dateien bzw.
Verzeichnisse vorhanden sind.</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="005003.html#EDRIVE">EDRIVE</a> :</td>
<td valign="top"><i>drv</i> ist kein gültiges BIOS-Gerät.</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="005003.html#ELOCKED">ELOCKED</a> :</td>
<td valign="top">Gerät ist bereits von einem Prozeß gesperrt.</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="005003.html#ENSLOCK">ENSLOCK</a> :</td>
<td valign="top">Gerät ist bereits freigegeben.

</td></tr>
</table>

</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top">Verfügbar, wenn ein 'MiNT' Cookie mit einer Versionsnummer von
mindestens 0.93 existiert und in <a href="00b.html">MagiC</a> ab Version 3.0.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"><a href="#Verzeichnisfunktionen">Verzeichnisfunktionen</a></td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"><a href="#Bindings_20f_C3_BCr_20Dlock">Binding</a> &nbsp; <a href="005009.html#Fxattr">Fxattr</a> &nbsp; <a href="00b015.html">XFS-Konzept in MagiC</a>

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Dlock"></a>5.15.10.1 Bindings für Dlock</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">int32_t <a href="#Dlock">Dlock</a> ( int16_t mode, int16_t drv );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>move.w    drv,-(sp)    ; Offset 4
move.w    mode,-(sp)   ; Offset 2
move.w    #309,-(sp)   ; Offset 0
trap      #1           ; <a href="005.html">GEMDOS</a> aufrufen
addq.l    #6,sp        ; Stack korrigieren
</pre>


</td></tr>
</table>

<h3><a name="Dopendir"></a>5.15.11 Dopendir</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»Dopendir« - öffnet ein Verzeichnis zum Lesen.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gemdosnummer:</td>
<td valign="top">296</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top">int32_t Dopendir ( int8_t *name, int16_t flag );</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top">Die Funktion öffnet das Verzeichnis <i>name</i> zum Lesen.
Der Parameter <i>name</i> muß NULL-terminiert sein und darf keinen
abschließenden Backslash enthalten. Der Parameter <i>flag</i>
beschreibt die Art und Weise, wie das Verzeichnis geöffnet werden
soll:<table>
<tr><td nowrap="nowrap" valign="top">flag</td>
<td valign="top">Bedeutung</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;</td>
<td valign="top">&nbsp;</td></tr>

<tr><td nowrap="nowrap" valign="top">0</td>
<td valign="top"><b>Normalmodus</b>
<br>In diesem Modus wird versucht, die Länge von Dateinamen nicht zu
begrenzen. Darüber hinaus gibt <a href="#Dreaddir">Dreaddir</a> in diesem Modus eine
Indexnummer (ähnlich den UNIX inode's) in den ersten 4 Bytes des
Dateinamens zurück.</td></tr>

<tr><td nowrap="nowrap" valign="top">1</td>
<td valign="top"><b>Kompatibilitätsmodus</b>
<br>In diesem Modus verhalten sich Dateisysteme so, als würden
<a href="005009.html#Fsfirst">Fsfirst</a>- bzw. <a href="005009.html#Fsnext">Fsnext</a>-Aufrufe benutzt. Insbesondere werden Dateinamen
nach DOS-Konvention auf 8+3 Zeichen verkürzt, wenn dies möglich ist.

</td></tr>
</table>

<br><br>

Neuere Programme sollten nach Möglichkeit immer den Normalmodus
benutzen, um die volle Funktionalität zu nutzen.</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top">Die Funktion liefert im Erfolgsfall eine 32bit
Verzeichnis-Handle. Diese darf auch negativ sein, enthält aber auf
keinen Fall den Wert 0xff im obersten Byte, wodurch es von Fehlern
unterschieden werden kann.<br><br>

Im Fehlerfall sind folgende Rückgabewerte möglich:<table>
<tr><td nowrap="nowrap" valign="top"><a href="005003.html#EPTHNF">EPTHNF</a> :</td>
<td valign="top"><i>name</i> ist kein gültiges Verzeichnis</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="005003.html#EACCDN">EACCDN</a> :</td>
<td valign="top">Das Verzeichnis ist von diesem Programm nicht ansprechbar.</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="005003.html#ENSMEM">ENSMEM</a> :</td>
<td valign="top">Der Kernel kann für diese Operation keinen Speicher
allozieren.

</td></tr>
</table>

</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top">Verfügbar, wenn ein 'MiNT' Cookie mit einer Versionsnummer von
mindestens 0.90 existiert und in <a href="00b.html">MagiC</a> ab Version 3.0.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"><a href="#Verzeichnisfunktionen">Verzeichnisfunktionen</a></td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"><a href="#Bindings_20f_C3_BCr_20Dopendir">Binding</a> &nbsp; <a href="#Dclosedir">Dclosedir</a> &nbsp; <a href="#Dreaddir">Dreaddir</a> &nbsp; <a href="#Drewinddir">Drewinddir</a> &nbsp; <a href="00500b.html#Pdomain">Pdomain</a>

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Dopendir"></a>5.15.11.1 Bindings für Dopendir</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">int32_t <a href="#Dopendir">Dopendir</a> ( int8_t *name, int16_t flag );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>move.w    flag,-(sp)   ; Offset 6
pea       name         ; Offset 2
move.w    #296,-(sp)   ; Offset 0
trap      #1           ; <a href="005.html">GEMDOS</a> aufrufen
addq.l    #8,sp        ; Stack korrigieren
</pre>


</td></tr>
</table>

<h3><a name="Dpathconf"></a>5.15.12 Dpathconf</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»Dpathconf« - Informationen über ein Filesystem ermitteln.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gemdosnummer:</td>
<td valign="top">292</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top">int32_t Dpathconf ( BYTE *name, int16_t mode );</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top">Die Funktion ermöglicht es Informationen über das Filesystem,
welches die Datei <i>name</i> enthält, zu ermitteln.<br><br>

Der Parameter <i>mode</i> gibt an, welche Möglichkeiten bzw.
Einschränkungen des Filesystems erfragt werden sollen. Mögliche
Werte sind hier:<table>
<tr><td nowrap="nowrap" valign="top">mode</td>
<td valign="top">Bedeutung</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;</td>
<td valign="top">&nbsp;</td></tr>

<tr><td nowrap="nowrap" valign="top">-1:</td>
<td valign="top">max. erlaubter Wert für Dpathconf selbst.<a name="DP_IOPEN"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">DP_IOPEN (0):</td>
<td valign="top">max. Anzahl der geöffneten Dateien.<a name="DP_MAXLINKS"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">DP_MAXLINKS (1):</td>
<td valign="top">max. Anzahl der Verweise (Links) auf eine Datei.<a name="DP_PATHMAX"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">DP_PATHMAX (2):</td>
<td valign="top">max. Länge des vollen Pfadnamens.<a name="DP_NAMEMAX"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">DP_NAMEMAX (3):</td>
<td valign="top">max. Länge eines Dateinamens.<a name="DP_ATOMIC"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">DP_ATOMIC (4):</td>
<td valign="top">Anzahl der Bytes, die auf einmal geschrieben werden können.<a name="DP_TRUNC"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">DP_TRUNC (5):</td>
<td valign="top"><b>Informationen über das Kürzen von Dateinamen:</b><table>
<tr><td nowrap="nowrap" valign="top">0 =</td>
<td valign="top">Dateinamen werden nicht gekürzt. Wenn bei einem Systemaufruf
die Länge des maximalen Dateinamens überschritten wird, wird der
Wert <a href="005003.html#ERANGE">ERANGE</a> zurückgeliefert.</td></tr>

<tr><td nowrap="nowrap" valign="top">1 =</td>
<td valign="top">Dateinamen werden automatisch auf die maximal mögliche Länge
verkürzt.</td></tr>

<tr><td nowrap="nowrap" valign="top">2 =</td>
<td valign="top">Dateinamen werden nach DOS-Konvention gekürzt. (also: 8
Zeichen Name, 3 Zeichen Extension).

</td></tr>
</table>

<a name="DP_CASE"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">DP_CASE (6):</td>
<td valign="top"><b>Informationen über Groß-/Kleinschreibung:</b><table>
<tr><td nowrap="nowrap" valign="top">0 =</td>
<td valign="top">Unterscheidung zwischen Groß-/Kleinschreibung.</td></tr>

<tr><td nowrap="nowrap" valign="top">1 =</td>
<td valign="top">keine Unterscheidung zwischen Groß-/Kleinschreibung (alle
Zeichen werden entweder in Groß-, oder in Kleinbuchstaben
umgewandelt).</td></tr>

<tr><td nowrap="nowrap" valign="top">2 =</td>
<td valign="top">keine Unterscheidung zwischen Groß-/Kleinschreibung. Das
Dateisystem speichert aber Pfad- und Dateinamen mit den Originalwerten
ab.<br>

Beispiel: Die angezeigte Datei 'HelloWorld' kann auch über
'HELLOWorld' oder 'HeLLoWORLD' angesprochen werden.

</td></tr>
</table>

<a name="_25dpthconf_7"></a>
<a name="DP_MODEATTR"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">DP_MODEATTR (7):</td>
<td valign="top"><b>Informationen über Modus-Bits einer Datei:</b><br><br>

Dieser Modus liefert Informationen über die Gültigkeit der in
den Feldern <i>mode</i> und <i>attr</i> der <a href="005014.html#XATTR">XATTR</a> Struktur
definierten Werte. Die Bits 0..5 beschreiben welche Flags der
Komponente <i>attr</i> gültig sind. Dabei gilt:<table>
<tr><td nowrap="nowrap" valign="top">FA_RDONLY (0x01):</td>
<td valign="top">wird nur gesetzt wenn die Leseberechtigung über dieses Bit
gesteuert wird, und <i>nicht</i>, wenn es über die Bedeutung der
mode-Bits emuliert wird.</td></tr>

<tr><td nowrap="nowrap" valign="top">FA_<a href="008002.html#HIDDEN">HIDDEN</a> (0x02):</td>
<td valign="top">&nbsp;</td></tr>

<tr><td nowrap="nowrap" valign="top">FA_SYSTEM (0x04):</td>
<td valign="top">wird gesetzt, wenn das Filesystem diese speziellen Attribute
unterstützt (normalerweise nur bei DOS Filesystemen der Fall).</td></tr>

<tr><td nowrap="nowrap" valign="top">FA_LABEL (0x08):</td>
<td valign="top">wird gesetzt, wenn das Filesystem-Label per <a href="005009.html#Fsfirst">Fsfirst</a>/<a href="005009.html#Fsnext">Fsnext</a>
ermittelt werden kann.</td></tr>

<tr><td nowrap="nowrap" valign="top">FA_DIR (0x10):</td>
<td valign="top">reserviert. Um zu entscheiden, ob es sich um einen Ordner auf
dem Filesystem handelt, sollte auf die Datei-Typ-Bits (s.u.)
zurückgegriffen werden.</td></tr>

<tr><td nowrap="nowrap" valign="top">FA_CHANGED (0x20):</td>
<td valign="top">wird gesetzt, wenn das Filesystem den Begriff des Archiv-Bits
kennt, und das attr-Feld für diesen Zweck benutzt wird.

</td></tr>
</table>

<br><br>

Die Bits 6 und 7 sind reserviert. In den Bits 8..19 werden
Informationen darüber abgelegt, ob die unteren 12-Bits der
<i>mode</i>-Komponente gültig sind. Die Bits 20..27 beschreiben,
welche Dateitypen von dem Filesystem unterstützt werden. Dabei gilt:<table>
<tr><td nowrap="nowrap" valign="top"><a href="00f00d.html#DP">DP</a>_FT_DIR (0x00100000L):</td>
<td valign="top">Ordner</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="00f00d.html#DP">DP</a>_FT_CHR (0x00200000L):</td>
<td valign="top">spezielle Character-Files</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="00f00d.html#DP">DP</a>_FT_BLK (0x00400000L):</td>
<td valign="top">spezielle Block-Files (z.Zt. unbenutzt)</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="00f00d.html#DP">DP</a>_FT_REG (0x00800000L):</td>
<td valign="top">Reguläre Dateien</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="00f00d.html#DP">DP</a>_FT_LNK (0x01000000L):</td>
<td valign="top">Symbolische Links</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="00f00d.html#DP">DP</a>_FT_SOCK (0x02000000L):</td>
<td valign="top">Sockets (z.Zt. unbenutzt)</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="00f00d.html#DP">DP</a>_FT_FIFO (0x04000000L):</td>
<td valign="top"><a href="00b00b.html#Pipes">Pipes</a></td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="00f00d.html#DP">DP</a>_FT_MEM (0x08000000L):</td>
<td valign="top">Shared Memory oder Prozess Dateien

</td></tr>
</table>

<br><br>

Die Bits 28..31 sind reserviert.<a name="_25dpthconf_8"></a>
<a name="DP_XATTRFIELDS"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">DP_XATTRFIELDS (8):</td>
<td valign="top"><b>Informationen über erweiterte Attribute:</b><br><br>

In diesem Modus wird eine Bit-Maske der unterstützten (in der
<a href="005014.html#XATTR">XATTR</a>-Struktur angegebenen) Felder zurückgeliefert. Es gilt:<table>
<tr><td nowrap="nowrap" valign="top"><a href="00f00d.html#DP">DP</a>_INDEX</td>
<td valign="top">(0x0001): <a href="indexudo.html">Index</a>-Feld für jede Datei auf dem Filesystem
eindeutig</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="00f00d.html#DP">DP</a>_DEV</td>
<td valign="top">(0x0002): Gerätenummer</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="00f00d.html#DP">DP</a>_RDEV</td>
<td valign="top">(0x0004): rdev-Feld gültig, und <i>nicht</i> zum dev-Feld
identisch</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="00f00d.html#DP">DP</a>_NLINK</td>
<td valign="top">(0x0008): Anzahl der Links</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="00f00d.html#DP">DP</a>_UID</td>
<td valign="top">(0x0010): Benutzernummer</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="00f00d.html#DP">DP</a>_GID</td>
<td valign="top">(0x0020): Gruppennummer</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="00f00d.html#DP">DP</a>_BLKSIZE</td>
<td valign="top">(0x0040): Blockgröße</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="00f00d.html#DP">DP</a>_SIZE</td>
<td valign="top">(0x0080): Dateilänge</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="00f00d.html#DP">DP</a>_NBLOCKS</td>
<td valign="top">(0x0100): Anzahl der Blöcke</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="00f00d.html#DP">DP</a>_ATIME</td>
<td valign="top">(0x0200): Zeit des letzten Zugriffs</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="00f00d.html#DP">DP</a>_CTIME</td>
<td valign="top">(0x0400): Zeit der Dateierstellung</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="00f00d.html#DP">DP</a>_MTIME</td>
<td valign="top">(0x0800): Zeit der letzten Änderung

</td></tr>
</table>

<br><br>

Alle anderen Bits sind für zukünftige Zwecke reserviert.<a name="DP_VOLNAMEMAX"></a>
</td></tr>

<tr><td nowrap="nowrap" valign="top">DP_VOLNAMEMAX (9):</td>
<td valign="top">maximum length of a volume name (0 if volume names not
supported)

</td></tr>
</table>

<br><br>

Ein Rückgabewert von 0x7fffffff (2^31 -1) bedeutet, daß es für
die erfragte Komponente keine Beschränkung gibt.<br><br>

<b>Hinweis:</b> In <a href="00b.html">MagiC</a> kann die Funktion auch auf
<i>Dateien</i> angewendet werden. Der Dateiname wird jedoch in diesem
Fall ignoriert, d.h. nur der Pfad wird ausgewertet. Die Funktion
sollte in MagiC ggf. nach <a href="#Dopendir">Dopendir</a> aufgerufen werden, da Dpathconf
keine Diskwechsel erkennt (Grund: wenn der Pfad noch im Cache ist,
wird <i>kein</i> Diskzugriff durchgeführt, und daher kein
Diskwechsel erkannt).</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top">Die Funktion liefert die Eigenschaften/Einschränkungen des
Filesystems bzgl. des Parameters <i>mode</i> zurück (s.o.).</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top">Seit der ersten in MultiTOS integrierten MiNT Version 1.04 und
in MagiC ab Version 3.0.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"><a href="#Verzeichnisfunktionen">Verzeichnisfunktionen</a></td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"><a href="#Bindings_20f_C3_BCr_20Dpathconf">Binding</a> <a href="00500e.html#Sysconf">Sysconf</a> &nbsp; <a href="00b015.html">XFS-Konzept in MagiC</a> &nbsp; <a href="005004.html">Test auf Pipes</a>

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Dpathconf"></a>5.15.12.1 Bindings für Dpathconf</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">int32_t <a href="#Dpathconf">Dpathconf</a> ( BYTE *name, int16_t mode );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>move.w    mode,-(sp)   ; Offset 6
pea       name         ; Offset 2
move.w    #292,-(sp)   ; Offset 0
trap      #1           ; <a href="005.html">GEMDOS</a> aufrufen
addq.l    #8,sp        ; Stack korrigieren
</pre>


</td></tr>
</table>

<h3><a name="Dreaddir"></a>5.15.13 Dreaddir</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»Dreaddir« - Verzeichnis Informationen lesen.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gemdosnummer:</td>
<td valign="top">297</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top">int32_t Dreaddir ( int16_t len, int32_t dirhandle, int8_t *buf
);</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top">Die Funktion liefert die nächste Datei im Verzeichnis
<i>dirhandle</i> zurück. Der Dateiname und ein optionaler 4Byte
<a href="indexudo.html">Index</a> für die Datei, werden in <i>buf</i> geschrieben.<br><br>

Der Dateiindex wird weggelassen, wenn das Verzeichnis im
Kompatibilitätsmodus geöffnet wurde, anderenfalls erscheint er als
erstes in <i>buf</i>, gefolgt von einem (nullterminierten)
Dateinamen.<br><br>

(Ggfs. unterschiedliche) Namen mit gleichem <a href="indexudo.html">Index</a>, gehören zur
selben Datei. (Ggfs gleiche) Namen mit unterschiedlichem <a href="indexudo.html">Index</a>
gehören zu verschiedenen Dateien.<br><br>

<b>Hinweis für MagiC:</b> Für FAT-Dateisysteme liefert die
Funktion die folgenden <a href="indexudo.html">Index</a>-Daten:<ul>
<li>Verzeichnisse: Startcluster im Motorola-Format</li>
<li>sonstige Dateien:<table>
<tr><td nowrap="nowrap" valign="top">Hiword =</td>
<td valign="top">Startcluster des Verzeichnisses</td></tr>

<tr><td nowrap="nowrap" valign="top">Loword =</td>
<td valign="top">Position innerhalb des Verzeichnisses >> 5
</td></tr>
</table>

</li>
</ul>

<br><br>

Dieses Verfahren ist ähnlich wie das, welches Linux und Solaris
verwenden. Nachteil ist, daß Dateien beim Verschieben ihren <a href="indexudo.html">Index</a>
ändern.<br><br>

In <i>len</i> muß die Größe des aufnehmenden Puffers angegeben
werden.</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top">Die Funktion kann folgende Rückgabewerte liefern:<table>
<tr><td nowrap="nowrap" valign="top"><a href="005003.html#E_OK">E_OK</a> :</td>
<td valign="top">kein Fehler aufgetreten.</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="005003.html#ENMFIL">ENMFIL</a> :</td>
<td valign="top">keine weiteren Dateien vorhanden.</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="005003.html#ERANGE">ERANGE</a> :</td>
<td valign="top">Die Pufferlänge ist nicht ausreichend.

</td></tr>
</table>

</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top">Verfügbar, wenn ein 'MiNT' Cookie mit einer Versionsnummer von
mindestens 0.90 existiert und in <a href="00b.html">MagiC</a> ab Version 3.0.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"><a href="#Verzeichnisfunktionen">Verzeichnisfunktionen</a></td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"><a href="#Bindings_20f_C3_BCr_20Dreaddir">Binding</a> &nbsp; <a href="#Dclosedir">Dclosedir</a> &nbsp; <a href="#Dopendir">Dopendir</a> &nbsp; <a href="#Drewinddir">Drewinddir</a> &nbsp; <a href="#Dxreaddir">Dxreaddir</a>

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Dreaddir"></a>5.15.13.1 Bindings für Dreaddir</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">int32_t <a href="#Dreaddir">Dreaddir</a> ( int16_t len, int32_t dirhandle, int8_t *buf
);</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>pea       buf          ; Offset 8
move.l    dirhandle    ; Offset 4
move.w    len          ; Offset 2
move.w    #297,-(sp)   ; Offset 0
trap      #1           ; <a href="005.html">GEMDOS</a> aufrufen
lea       $C(sp),sp    ; Stack korrigieren
</pre>


</td></tr>
</table>

<h3><a name="Dreadlabel"></a>5.15.14 Dreadlabel</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»Dreadlabel« - Filesystem Label lesen.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gemdosnummer:</td>
<td valign="top">338 (0x0152)</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top">int32_t Dreadlabel ( CONST int8_t *path, int8_t *label, int16_t
length );</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top">Die Funktion liefert in <i>label</i> den Namen des auf
<i>path</i> liegenden Filesystems zurück. Der Parameter
<i>length</i> gibt die Größe des aufnehmendes Puffers <i>label</i>
an.</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top">Die Funktion kann folgende Rückgabewerte liefern:<table>
<tr><td nowrap="nowrap" valign="top"><a href="005003.html#E_OK">E_OK</a> :</td>
<td valign="top">kein Fehler aufgetreten</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="005003.html#ENAMETOOLONG">ENAMETOOLONG</a> :</td>
<td valign="top">Der Name des Filesystems ist länger als die Größe des
aufnehmenden Puffers.

</td></tr>
</table>

</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top">MagiC ab Version 3.0, ab MiNT 1.12</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"><a href="#Verzeichnisfunktionen">Verzeichnisfunktionen</a></td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"><a href="#Bindings_20f_C3_BCr_20Dreadlabel">Binding</a> &nbsp; <a href="#Dwritelabel">Dwritelabel</a> &nbsp; <a href="00b015.html">XFS-Konzept in MagiC</a>

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Dreadlabel"></a>5.15.14.1 Bindings für Dreadlabel</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">int32_t <a href="#Dreadlabel">Dreadlabel</a> ( CONST int8_t *path, int8_t *label, int16_t
length );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>move.w    length,-(sp)  ; Offset 10
pea       label         ; Offset  6
pea       path          ; Offset  2
move.w    #338,-(sp)    ; Offset  0
trap      #1            ; <a href="005.html">GEMDOS</a> aufrufen
lea       $C(sp),sp     ; Stack korrigieren
</pre>


</td></tr>
</table>

<h3><a name="Drewinddir"></a>5.15.15 Drewinddir</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»Drewinddir« - geöffnetes Verzeichnis zurücksetzen.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gemdosnummer:</td>
<td valign="top">298</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top">int32_t Drewinddir ( int32_t handle );</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top">Die Funktion setzt das Verzeichnis <i>handle</i> auf den
Anfang zurück, so daß der nächste Aufruf von Dreaddir wieder den
ersten Eintrag im Verzeichnis liest.</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top">Die Funktion kann folgende Rückgabewerte liefern:<table>
<tr><td nowrap="nowrap" valign="top"><a href="005003.html#E_OK">E_OK</a> :</td>
<td valign="top">kein Fehler aufgetreten.</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="005003.html#EINVFN">EINVFN</a> :</td>
<td valign="top">Verzeichnis kann nicht zurückgesetzt werden.</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="005003.html#EIHNDL">EIHNDL</a> :</td>
<td valign="top">Das Verzeichnis <i>handle</i> ist nicht geöffnet.

</td></tr>
</table>

</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top">Verfügbar, wenn ein 'MiNT' Cookie mit einer Versionsnummer von
mindestens 0.90 existiert und in <a href="00b.html">MagiC</a> ab Version 3.0.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"><a href="#Verzeichnisfunktionen">Verzeichnisfunktionen</a></td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"><a href="#Bindings_20f_C3_BCr_20Drewinddir">Binding</a> &nbsp; <a href="#Dopendir">Dopendir</a> &nbsp; <a href="#Dreaddir">Dreaddir</a>

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Drewinddir"></a>5.15.15.1 Bindings für Drewinddir</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">int32_t <a href="#Drewinddir">Drewinddir</a> ( int32_t handle );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>move.l    handle,-(sp)  ; Offset 2
move.w    #298,-(sp)    ; Offset 0
trap      #1            ; <a href="005.html">GEMDOS</a> aufrufen
addq.l    #6,sp         ; Stack korrigieren
</pre>


</td></tr>
</table>

<h3><a name="Dsetdrv"></a>5.15.16 Dsetdrv</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»disk set drive« - legt das aktuelle Laufwerk fest und
liefert eine Bitmap sämtlicher gemounteter Laufwerke.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gemdosnummer:</td>
<td valign="top">14</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top">int32_t Dsetdrv ( int16_t drv );</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top">Die <a href="005.html">GEMDOS</a>-Routine Dsetdrv macht das Laufwerk <i>drv</i> zum
aktuellen Laufwerk. Es gilt:<table>
<tr><td nowrap="nowrap" valign="top">drv</td>
<td valign="top">Bedeutung</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;</td>
<td valign="top">&nbsp;</td></tr>

<tr><td nowrap="nowrap" valign="top">0</td>
<td valign="top">Laufwerk A</td></tr>

<tr><td nowrap="nowrap" valign="top">1</td>
<td valign="top">Laufwerk B</td></tr>

<tr><td nowrap="nowrap" valign="top">2</td>
<td valign="top">Laufwerk C (usw.)

</td></tr>
</table>

<br><br>

<b>Hinweis:</b> Eine falsche Laufwerksnummer kann zu schweren
Schäden in GEMDOS-internen Strukturen führen. Die vom GEMDOS
unterstützten Laufwerke erfragt man am besten wie folgt:<pre>Dsetdrv (<a href="#Dgetdrv">Dgetdrv</a> ());
</pre>
<br><br>

Ab <a href="00b.html">MagiC</a> 3 sind Laufwerke von A bis Z, d.h. Werte von 0 bis 25
zulässig. Es wird nicht überprüft, ob das angegebene Laufwerk
überhaupt existiert.<br><br>

<a href="005.html">GEMDOS</a> 0.30 (<a href="002.html">TOS</a> 4.00-4.04) gibt für Laufwerke über P
fälschlich <a href="005003.html#EDRIVE">EDRIVE</a> zurück!</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top">Die Funktion liefert als Ergebnis eine Bit-Tabelle mit allen
angeschlossenen Laufwerken. Jedes angeschlossene Laufwerk wird mit
einem gesetzten Bit angezeigt.</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top">Alle <a href="005.html">GEMDOS</a> Versionen.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"><a href="#Verzeichnisfunktionen">Verzeichnisfunktionen</a></td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"><a href="#Bindings_20f_C3_BCr_20Dsetdrv">Binding</a> &nbsp; <a href="#Dgetdrv">Dgetdrv</a> &nbsp; <a href="003004.html#_drvbits">_drvbits</a>

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Dsetdrv"></a>5.15.16.1 Bindings für Dsetdrv</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">int32_t <a href="#Dsetdrv">Dsetdrv</a> ( int16_t drv );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>move.w    drv,-(sp)    ; Offset 2
move.w    #14,-(sp)    ; Offset 0
trap      #1           ; <a href="005.html">GEMDOS</a> aufrufen
addq.l    #4,sp        ; Stack korrigieren
</pre>
</td></tr>

<tr><td nowrap="nowrap" valign="top">GFA-Basic</td>
<td valign="top">Fehler%=Gemdos(&H0E,W:drv%)

</td></tr>
</table>

<h3><a name="Dsetpath"></a>5.15.17 Dsetpath</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»set path« - legt das aktuelle Verzeichnis fest.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gemdosnummer:</td>
<td valign="top">59</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top">int16_t Dsetpath ( CONST int8_t *path );</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top">Die <a href="005.html">GEMDOS</a>-Routine Dsetpath setzt einen neuen Zugriffspfad für
das aktuelle Laufwerk. Der Parameter <i>path</i> enthält den neuen
aktuellen Zugriffspfad für das Laufwerk.<br><br>

<b>Hinweis:</b> Für jedes Laufwerk merkt sich GEMDOS das
aktuelle Verzeichnis. Die Funktion Dsetpath sollte aber nur für das
aktuelle Laufwerk benutzt werden. Für andere Laufwerke sollte
hingegen die folgende Methode angewendet werden:<ul>
<li>aktuelles Laufwerk ermitteln</li>
<li>gewünschtes Laufwerk setzen</li>
<li>Pfad für dieses Laufwerk setzen</li>
<li>das alte (gemerkte) Laufwerk wieder zum aktuellen machen.</li>
</ul>

<br><br>

Auf einigen (älteren) Versionen von GEMDOS kann ein zu häufiges
Setzen von nicht existierenden Pfaden zu Störungen in internen
Strukturen führen.</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top">Die Funktion liefert folgende Resultate:<table>
<tr><td nowrap="nowrap" valign="top">Wert</td>
<td valign="top">Bedeutung</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;</td>
<td valign="top">&nbsp;</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="005003.html#E_OK">E_OK</a></td>
<td valign="top">kein Fehler aufgetreten</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="005003.html#EPTHNF">EPTHNF</a></td>
<td valign="top">Verzeichnis nicht gefunden

</td></tr>
</table>

</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top">Alle GEMDOS Versionen.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"><a href="#Verzeichnisfunktionen">Verzeichnisfunktionen</a></td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"><a href="#Bindings_20f_C3_BCr_20Dsetpath">Binding</a> &nbsp; <a href="#Dgetpath">Dgetpath</a>

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Dsetpath"></a>5.15.17.1 Bindings für Dsetpath</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">int16_t <a href="#Dsetpath">Dsetpath</a> ( CONST int8_t *path );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>pea       path         ; Offset 2
move.w    #59,-(sp)    ; Offset 0
trap      #1           ; <a href="005.html">GEMDOS</a> aufrufen
addq.l    #6,sp        ; Stack korrigieren
</pre>
</td></tr>

<tr><td nowrap="nowrap" valign="top">GFA-Basic</td>
<td valign="top">Fehler%=Gemdos(&H3B,L:path%)

</td></tr>
</table>

<h3><a name="Dwritelabel"></a>5.15.18 Dwritelabel</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»Dwritelabel« - Filesystem Label setzen.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gemdosnummer:</td>
<td valign="top">339 (0x0153)</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top">int32_t Dwritelabel ( CONST int8_t *path, CONST int8_t *label
);</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top">Die Funktion schreibt den in <i>label</i> angegebenen Namen
auf das in <i>path</i> angegebene Filesystem.<br><br>

Prior to MiNT version 1.14.5 this call contained a bug that
allowed the label to be changed by all users.</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top"><a href="005003.html#E_OK">E_OK</a> wenn erfolgreich oder einen negativen GEMDOS Fehlercode.</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top">MagiC ab Version 3.0, MiNT 1.12</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"><a href="#Verzeichnisfunktionen">Verzeichnisfunktionen</a></td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"><a href="#Bindings_20f_C3_BCr_20Dwritelabel">Binding</a> &nbsp; <a href="#Dreadlabel">Dreadlabel</a> &nbsp; <a href="00b015.html">XFS-Konzept in MagiC</a>

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Dwritelabel"></a>5.15.18.1 Bindings für Dwritelabel</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">int32_t <a href="#Dwritelabel">Dwritelabel</a> ( CONST int8_t *path, CONST int8_t *label
);</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>pea       label        ; Offset 6
pea       path         ; Offset 2
move.w    #339,-(sp)   ; Offset 0
trap      #1           ; <a href="005.html">GEMDOS</a> aufrufen
lea       $A(sp),sp    ; Stack korrigieren
</pre>


</td></tr>
</table>

<h3><a name="Dxopendir"></a>5.15.19 Dxopendir</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»Dxopendir« - öffnet ein Verzeichnis zum Lesen.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gemdosnummer:</td>
<td valign="top">1296</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top">int32_t Dxopendir ( int8_t *name, int16_t flag );</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top">Dxopendir ruft das normale <a href="#Dopendir">Dopendir</a> auf, speichert allerdings
dann das zurückgegebene Handle und Flag in einer verketten Liste so
wissen <a href="#Dreaddir">Dreaddir</a> und <a href="#Dxreaddir">Dxreaddir</a> das sie bei diesem Verzeichnis wandeln
müssen. Dcloseddir löscht das Handle wieder aus der Liste.<br><br>

Dreaddirund Dxreaddir wandeln den zurück gegebenen Namen in
Kleinbuchstaben.<br><br>

Die Funktion öffnet das Verzeichnis <i>name</i> zum Lesen. Der
Parameter <i>flag</i> beschreibt die Art und Weise, wie das
Verzeichnis geöffnet werden soll:<table>
<tr><td nowrap="nowrap" valign="top">flag</td>
<td valign="top">Bedeutung</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;</td>
<td valign="top">&nbsp;</td></tr>

<tr><td nowrap="nowrap" valign="top">0</td>
<td valign="top"><b>Normalmodus</b>
<br>In diesem Modus wird versucht, die Länge von Dateinamen nicht zu
begrenzen. Darüber hinaus gibt <a href="#Dreaddir">Dreaddir</a> in diesem Modus eine
Indexnummer (ähnlich den UNIX inode's) in den ersten 4 Bytes des
Dateinamens zurück.</td></tr>

<tr><td nowrap="nowrap" valign="top">1</td>
<td valign="top"><b>Kompatibilitätsmodus</b>
<br>In diesem Modus verhalten sich Dateisysteme so, als würden
<a href="005009.html#Fsfirst">Fsfirst</a>- bzw. <a href="005009.html#Fsnext">Fsnext</a>-Aufrufe benutzt. Insbesondere werden Dateinamen
nach DOS-Konvention auf 8+3 Zeichen verkürzt, wenn dies möglich ist.

</td></tr>
</table>

<br><br>

Neuere Programme sollten nach Möglichkeit immer den Normalmodus
benutzen, um die volle Funktionalität zu nutzen.</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top">Die Funktion liefert im Erfolgsfall eine 32bit
Verzeichnis-Handle. Diese darf auch negativ sein, enthält aber auf
keinen Fall den Wert 0xff im obersten Byte, wodurch es von Fehlern
unterschieden werden kann.<br><br>

Im Fehlerfall sind folgende Rückgabewerte möglich:<table>
<tr><td nowrap="nowrap" valign="top"><a href="005003.html#EPTHNF">EPTHNF</a> :</td>
<td valign="top"><i>name</i> ist kein gültiges Verzeichnis</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="005003.html#EACCDN">EACCDN</a> :</td>
<td valign="top">Das Verzeichnis ist von diesem Programm nicht ansprechbar.</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="005003.html#ENSMEM">ENSMEM</a> :</td>
<td valign="top">Der Kernel kann für diese Operation keinen Speicher
allozieren.

</td></tr>
</table>

</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top">Wenn die Systemerweiterung Dir_Lwr (liegt Égale 4.2 bei)
installiert ist. Legt den Cookie 'DYDL' an.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"><a href="#Verzeichnisfunktionen">Verzeichnisfunktionen</a></td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"><a href="#Bindings_20f_C3_BCr_20Dxopendir">Binding</a> &nbsp; <a href="#Dclosedir">Dclosedir</a> &nbsp; <a href="#Dreaddir">Dreaddir</a> &nbsp; <a href="#Drewinddir">Drewinddir</a> &nbsp; <a href="00500b.html#Pdomain">Pdomain</a>

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Dxopendir"></a>5.15.19.1 Bindings für Dxopendir</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">int32_t <a href="#Dxopendir">Dxopendir</a> ( int8_t *name, int16_t flag );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>move.w    flag,-(sp)   ; Offset 6
pea       name         ; Offset 2
move.w    #1296,-(sp)  ; Offset 0
trap      #1           ; <a href="005.html">GEMDOS</a> aufrufen
addq.l    #8,sp        ; Stack korrigieren
</pre>


</td></tr>
</table>

<h3><a name="Dxreaddir"></a>5.15.20 Dxreaddir</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»Dxreaddir« - Verzeichnis Informationen lesen.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gemdosnummer:</td>
<td valign="top">322, (0x142)</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top">int32_t Dxreaddir ( int16_t ln, int32_t dirh, int8_t *buf,
<a href="005014.html#XATTR">XATTR</a> *xattr, int32_t *xr );</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top">Die Funktion liefert die nächste Datei aus dem Verzeichnis mit
dem Handle <i>dirh</i>. Der Dateiname und der optionale 4 Bytes
große Dateiindex werden in dem durch <i>buf</i> spezifizierten
Puffer abgelegt.<br><br>

Der Dateiindex wird weggelassen, wenn bei <a href="#Dopendir">Dopendir</a> der
Kompatibilitätmodus angegeben wurde. Wenn zwei Dateinamen den
gleichen <a href="indexudo.html">Index</a> besitzen, stehen sie für die selbe Datei.<br><br>

<a href="00b.html">MagiC</a> liefert für FAT-Dateisysteme die folgenden <a href="indexudo.html">Index</a>-Daten:<ul>
<li>Verzeichnisse: Startcluster im Motorola-Format</li>
<li>sonstige Dateien:<table>
<tr><td nowrap="nowrap" valign="top">Hiword =</td>
<td valign="top">Startcluster des Verzeichnisses</td></tr>

<tr><td nowrap="nowrap" valign="top">Loword =</td>
<td valign="top">Position innerhalb des Verzeichnisses >> 5
</td></tr>
</table>

</li>
</ul>

<br><br>

Dieses Verfahren ist ähnlich wie das, welches Linux und Solaris
verwenden. Nachteil ist, daß Dateien beim Verschieben ihren <a href="indexudo.html">Index</a>
ändern.<br><br>

Der Parameter <i>ln</i> gibt die Länge des aufnehmendes Puffers
<i>buf</i> an. Die erweiterten Dateiattribute werden analog zu <a href="005009.html#Fxattr">Fxattr</a>
in der Struktur <i>xattr</i> abgelegt, wobei symbolische Links nicht
aufgelöst werden.<br><br>

<b>Hinweis:</b> Dieser Teil des Aufrufs kann fehlschlagen, obwohl
der Dateiname lesbar war. In diesem Fall wird ein getrennter
Returncode in dem long-Wert abgelegt, auf das der Parameter <i>xr</i>
zeigt.</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top">Die Funktion kann folgende Rückgabewerte liefern:<table>
<tr><td nowrap="nowrap" valign="top"><a href="005003.html#E_OK">E_OK</a> :</td>
<td valign="top">kein Fehler aufgetreten.</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="005003.html#ENMFIL">ENMFIL</a> :</td>
<td valign="top">keine weiteren Dateien gefunden.</td></tr>

<tr><td nowrap="nowrap" valign="top"><a href="005003.html#ERANGE">ERANGE</a> :</td>
<td valign="top">der aufnehmende Puffer ist nicht groß genug.

</td></tr>
</table>

</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top">MagiC ab Version 3.0, ab MiNT 1.11</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"><a href="#Verzeichnisfunktionen">Verzeichnisfunktionen</a></td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"><a href="#Bindings_20f_C3_BCr_20Dxreaddir">Binding</a> &nbsp; <a href="#Dreaddir">Dreaddir</a> &nbsp; <a href="#Dopendir">Dopendir</a> &nbsp; <a href="#Dclosedir">Dclosedir</a> &nbsp; <a href="#Drewinddir">Drewinddir</a>

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Dxreaddir"></a>5.15.20.1 Bindings für Dxreaddir</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">int32_t <a href="#Dxreaddir">Dxreaddir</a> ( int16_t ln, int32_t dirh, int8_t *buf,
<a href="005014.html#XATTR">XATTR</a> *xattr, int32_t *xr );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>pea       xr           ; Offset 16
pea       xattr        ; Offset 12
pea       buf          ; Offset  8
move.l    dirh         ; Offset  4
move.w    ln           ; Offset  2
move.w    #322,-(sp)   ; Offset  0
trap      #1           ; <a href="005.html">GEMDOS</a> aufrufen
lea       $14(sp),sp   ; Stack korrigieren
</pre>


</td></tr>
</table>

<hr>

<a id="UDO_nav_hm_FOOT" href="index.html"><img src="udo_hm.gif" alt="Home" title="Home" border="0" width="24" height="24"></a><a id="UDO_nav_up_FOOT" href="005.html"><img src="udo_up.gif" alt="GEMDOS" title="GEMDOS" border="0" width="24" height="24"></a><a id="UDO_nav_lf_FOOT" href="00500e.html"><img src="udo_lf.gif" alt="Systemfunktionen" title="Systemfunktionen" border="0" width="24" height="24"></a><a id="UDO_nav_rg_FOOT" href="005010.html"><img src="udo_rg.gif" alt="Zeichenweise Ein-/Ausgabe" title="Zeichenweise Ein-/Ausgabe" border="0" width="24" height="24"></a></body>
</html>
