<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html lang="de">
<head>
<title>
Die Anleitung zum TOS: Text block transfer
</title>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Content-Language" content="de">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<meta name="Generator" content="UDO 7.04 (1296) for Linux">
</head>
<body>
<? include "/var/www/banner.php"; ?>

<a id="UDO_nav_hm_HEAD" href="index.html"><img src="udo_hm.gif" alt="Home" title="Home" border="0" width="24" height="24"></a><a id="UDO_nav_up_HEAD" href="006.html"><img src="udo_up.gif" alt="Line-A" title="Line-A" border="0" width="24" height="24"></a><a id="UDO_nav_lf_HEAD" href="00600c.html"><img src="udo_lf.gif" alt="Bit block transfer" title="Bit block transfer" border="0" width="24" height="24"></a><a id="UDO_nav_rg_HEAD" href="00600e.html"><img src="udo_rg.gif" alt="Show mouse" title="Show mouse" border="0" width="24" height="24"></a>
<hr>

<h1><a name="Text_20block_20transfer"></a>6.13 Text block transfer</h1>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»Text block transfer«</td></tr>

<tr><td nowrap="nowrap" valign="top">Line-A Nummer:</td>
<td valign="top"> $A008</td></tr>

<tr><td nowrap="nowrap" valign="top">Binding:</td>
<td valign="top"><a href="#Bindings_20f_C3_BCr_20text_blt">Bindings für text_blt</a></td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top">Diese <a href="006.html">Line-A</a> Funktion gibt ein einzelnes Zeichen aus. Die
Quelle für das Zeichen muß den gleichen Aufbau wie in einem GDOS
Rasterfont haben. Man kann die Fontdaten als ein großes Bild
betrachten, dessen Höhe der Zeichenhöhe entspricht. Sämtliche
Zeichen stehen dicht nebeneinander in diesem "Bild". Zusätzlich
enthält ein GDOS Font eine Offset Tabelle, in der für jedes Zeichen
der Offset in diesem großen Bild steht. Der Parameter ade_lo des
Fontheaders gibt dabei das erste ASCII Zeichen an, für das ein Image
und damit auch ein Offset enthalten ist. Dieser Offset ist neben dem
Anfang der Fontdaten an diese <a href="006.html">Line-A</a> Funktion zu übergeben. Der
Y-Offset ist gewöhnlich 0. Da <a href="006.html">Line-A</a> die Zeichensätze nicht selbst
verwaltet und auch den Fontheader nicht kennt, müssen entsprechende
Paramter auf die Fontdaten übergeben werden. Hinzu kommen eine Reihe
weiterer Paramter für die diversen Effekte wie z.B. kursiv, ... Die
folgenden <a href="006.html">Line-A</a> Variablen werden benutzt:<table>
<tr><td nowrap="nowrap" valign="top">Variable</td>
<td valign="top">Bedeutung</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;</td>
<td valign="top">&nbsp;</td></tr>

<tr><td nowrap="nowrap" valign="top">wrt_mode</td>
<td valign="top">Schreibmodes, es sind die folgenden Modie möglich:<table>
<tr><td nowrap="nowrap" valign="top">REPLACE 0</td>
<td valign="top">Replace</td></tr>

<tr><td nowrap="nowrap" valign="top">TRANS 1</td>
<td valign="top">Transparent (OR)</td></tr>

<tr><td nowrap="nowrap" valign="top">XOR 2</td>
<td valign="top">Inverse (XOR)</td></tr>

<tr><td nowrap="nowrap" valign="top">INVERS 3</td>
<td valign="top">Inverse Transparent (XOR mit not(LN_MASK))
</td></tr>
</table>

</td></tr>

<tr><td nowrap="nowrap" valign="top">xacc_dda</td>
<td valign="top">Sollte vor jedem Aufruf auf $8000 gesetzt werden.</td></tr>

<tr><td nowrap="nowrap" valign="top">dda_inc</td>
<td valign="top">Vergrößerungsfaktor.</td></tr>

<tr><td nowrap="nowrap" valign="top">t_sclsts</td>
<td valign="top">Vergrößerungsrichtung, also ob Verkleinert oder Vergrößert
wird.</td></tr>

<tr><td nowrap="nowrap" valign="top">mono_status</td>
<td valign="top">1 wenn sämtliche Zeichen die gleiche Breite haben, es also ein
nichtproportionaler Font ist, sonst 0.</td></tr>

<tr><td nowrap="nowrap" valign="top">sourcex</td>
<td valign="top">X-Koordinate des auszugebenden Zeichens im Font und kann durch
die Offset Tabelle ermittelt werden.</td></tr>

<tr><td nowrap="nowrap" valign="top">sourcey</td>
<td valign="top">Y-Koordinate des auszugebenden Zeichens im Font, normalerweise
0.</td></tr>

<tr><td nowrap="nowrap" valign="top">destx</td>
<td valign="top">X-Koordinate der Bildschirmposition, an der das Zeichen
ausgegeben werden soll.</td></tr>

<tr><td nowrap="nowrap" valign="top">desty</td>
<td valign="top">Y-Koordinate der Bildschirmposition, an der das Zeichen
ausgegeben werden soll.</td></tr>

<tr><td nowrap="nowrap" valign="top">delx</td>
<td valign="top">Breite des Zeichens, kann ebenfalls aus dem Fontheader
ermittelt werden.</td></tr>

<tr><td nowrap="nowrap" valign="top">dely</td>
<td valign="top">Höhe des Zeichens, kann ebenfalls aus dem Fontheader ermittelt
werden.</td></tr>

<tr><td nowrap="nowrap" valign="top">fbase</td>
<td valign="top">Der Zeiger auf die Fontdaten, also das "Bild" mit den einzelnen
Zeichen.</td></tr>

<tr><td nowrap="nowrap" valign="top">fwidth</td>
<td valign="top">Breite des Fontimage.</td></tr>

<tr><td nowrap="nowrap" valign="top">style</td>
<td valign="top">Gibt die <a href="007004.html#Texteffekte">Texteffekte</a> an. Einzelne Bits stehen für einzelne
Effekte und können kombiniert werden:<table>
<tr><td nowrap="nowrap" valign="top">Bit 0</td>
<td valign="top">Fettschrift</td></tr>

<tr><td nowrap="nowrap" valign="top">Bit 1</td>
<td valign="top">Helle Schrift</td></tr>

<tr><td nowrap="nowrap" valign="top">Bit 2</td>
<td valign="top">Kursivschrift</td></tr>

<tr><td nowrap="nowrap" valign="top">Bit 3</td>
<td valign="top">Unterstrichen (wird ignoriert)</td></tr>

<tr><td nowrap="nowrap" valign="top">Bit 4</td>
<td valign="top">Umrissene Schrift "outline"
</td></tr>
</table>

</td></tr>

<tr><td nowrap="nowrap" valign="top">litemask</td>
<td valign="top">Eine Maske für helle (light) Schrift.</td></tr>

<tr><td nowrap="nowrap" valign="top">skewmask</td>
<td valign="top">Eine Maske für kursive (skew) Schrift.</td></tr>

<tr><td nowrap="nowrap" valign="top">weight</td>
<td valign="top">Die Breite bei Fettschrift (Bold).</td></tr>

<tr><td nowrap="nowrap" valign="top">r_off</td>
<td valign="top">Der rechten Offset für Kursivschrift, also quasi ein Paramter
für die "Schrägstellung" des Zeichens.</td></tr>

<tr><td nowrap="nowrap" valign="top">l_off</td>
<td valign="top">Der linke Offset für Kursivschrift, also quasi ein Paramter
für die "Schrägstellung" des Zeichens.</td></tr>

<tr><td nowrap="nowrap" valign="top">scale</td>
<td valign="top">1, wenn eine Skalierung erwünscht ist.</td></tr>

<tr><td nowrap="nowrap" valign="top">chup</td>
<td valign="top">Rotationswinkel in 1/10 Grad. Es sind allerdings nur Drehungen
um ein Vielfaches von 90 Grad möglich, also die Werte 0, 900, 1800,
2700.</td></tr>

<tr><td nowrap="nowrap" valign="top">text_fg</td>
<td valign="top">Textfarbe.</td></tr>

<tr><td nowrap="nowrap" valign="top">text_bg</td>
<td valign="top">Hintergrundfarbe.</td></tr>

<tr><td nowrap="nowrap" valign="top">scrtchp</td>
<td valign="top">Ein Puffer, der doppelt soviel Platz bieten sollte, wie das
Zeichen belegt, damit Line-A die <a href="007004.html#Texteffekte">Texteffekte</a> berechnen kann.</td></tr>

<tr><td nowrap="nowrap" valign="top">scrpt2</td>
<td valign="top"> Ein <a href="indexudo.html">Index</a> in den Puffer, der auf die Puffermitte zeigt, also
die halbe Puffergröße angibt.</td></tr>

<tr><td nowrap="nowrap" valign="top">clip</td>
<td valign="top"> 1 wenn <a href="VDI_fundamentals.html#Clipping">Clipping</a> gewünscht wird, 0 sonst.</td></tr>

<tr><td nowrap="nowrap" valign="top">xmn_clip</td>
<td valign="top"> X-Koordinate die linken oberen Ecke des <a href="VDI_fundamentals.html#Clipping">Clipping</a> Bereichs,
wenn <a href="VDI_fundamentals.html#Clipping">Clipping</a> eingeschaltet ist.</td></tr>

<tr><td nowrap="nowrap" valign="top">ymn_clip</td>
<td valign="top"> Y-Koordinate die linken oberen Ecke des <a href="VDI_fundamentals.html#Clipping">Clipping</a> Bereichs,
wenn <a href="VDI_fundamentals.html#Clipping">Clipping</a> eingeschaltet ist.</td></tr>

<tr><td nowrap="nowrap" valign="top">xmx_clip</td>
<td valign="top"> X-Koordinate der rechten unteren Ecke des <a href="VDI_fundamentals.html#Clipping">Clipping</a> Bereichs,
wenn <a href="VDI_fundamentals.html#Clipping">Clipping</a> eingeschaltet ist.</td></tr>

<tr><td nowrap="nowrap" valign="top">ymx_clip</td>
<td valign="top"> Y-Koordinate der rechten unteren Ecke des <a href="VDI_fundamentals.html#Clipping">Clipping</a> Bereichs,
wenn <a href="VDI_fundamentals.html#Clipping">Clipping</a> eingeschaltet ist.

</td></tr>
</table>

<br><br>

Das Binding von TC übergibt einen Zeiger auf den Font Header,
Flags für Skalierung, Stil, Rotationsvektor, Vorder- und
Hintergrundfarbe nicht an die text_blt Funktion, sondern benutzt die
separate Funktion set_text_blt() zum Setzen der Parameter in dem
<a href="006.html">Line-A</a> Paramterblock. Daten über den Font werden dabei automatisch
gesetzt.</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top">Die Funktion liefert keinen Returnwert.</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top">Alle <a href="002.html">TOS</a>-Versionen.</td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"><a href="#Bindings_20f_C3_BCr_20text_blt">Binding</a> &nbsp; <a href="00600c.html">Bit block transfer</a>

</td></tr>
</table>

<h3><a name="Bindings_20f_C3_BCr_20text_blt"></a>6.13.1 Bindings für text_blt</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Pure-C:</td>
<td valign="top">void text_blt( int16_t x, int16_t y, uint8_t c );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>movem.l   D0-D2/A0-A2,-(A7)  ; Register retten
move.l    pParamblk,A0       ; Zeiger Parameterblock <a href="006002.html">LINEA</a>
move.w    wmode,(36,A0)      ; Writemode in <a href="006002.html">LINEA</a>.wrt_mode
move.w    mode,(54,A0)       ; Clipmode in <a href="006002.html">LINEA</a>.clip
move.w    cx1,(56,A0)        ; linke obere Clip-Ecke, X-Koordinate in <a href="006002.html">LINEA</a>.xmn_clip
move.w    cy1,(58,A0)        ; linke obere Clip-Ecke, Y-Koordinate in <a href="006002.html">LINEA</a>.ymn_clip
move.w    cx2,(60,A0)        ; rechte untere Clip-Ecke, X-Koordinate in <a href="006002.html">LINEA</a>.xmx_clip
move.w    cy2,(62,A0)        ; rechte untere Clip-Ecke, Y-Koordinate in <a href="006002.html">LINEA</a>.ymx_clip
move.w    #$8000,(64,A0)     ; xacc_dda mit $8000 besetzen
move.w    dda_inc,(66,A0)    ; Vergrößerungsfaktor in <a href="006002.html">LINEA</a>.dda_inc
move.w    t_sclsts,(68,A0)   ; Vergrößerungsrichtung in <a href="006002.html">LINEA</a>.t_sclsts
move.w    mono_status,(70,A0); Proportionalschrift in <a href="006002.html">LINEA</a>.mono_status
move.w    sourcex,(72,A0)    ; X-Koordinate im Font in <a href="006002.html">LINEA</a>.sourcex
move.w    sourcey,(74,A0)    ; Y-Koordinate im Font in <a href="006002.html">LINEA</a>.sourcey
move.w    destx,(76,A0)      ; X-Zielkoordinate in <a href="006002.html">LINEA</a>.destx
move.w    desty,(78,A0)      ; Y-Zielkoordinate in <a href="006002.html">LINEA</a>.desty
move.w    delx,(80,A0)       ; Breite des Zeichens in <a href="006002.html">LINEA</a>.delx
move.w    dely,(82,A0)       ; Höhe des Zeichens in <a href="006002.html">LINEA</a>.dely
move.l    fbase,(84,A0)      ; Start der Font-Daten in <a href="006002.html">LINEA</a>.fbase
move.w    fwidth,(88,A0)     ; Breite des Fontimage in <a href="006002.html">LINEA</a>.fwidth
move.w    style,(90,A0)      ; Schreibstil in <a href="006002.html">LINEA</a>.style
move.w    litemask,(92,A0)   ; Maske für Light in <a href="006002.html">LINEA</a>.litemask
move.w    skewmask,(94,A0)   ; Maske für Kursiv in <a href="006002.html">LINEA</a>.skewmask
move.w    weight,(96,A0)     ; Breite bei Bold in <a href="006002.html">LINEA</a>.weight
move.w    r_off,(98,A0)      ; Kursiv-Offset rechts in <a href="006002.html">LINEA</a>.r_off
move.w    l_off,(100,A0)     ; Kursiv-Offset links in <a href="006002.html">LINEA</a>.l_off
move.w    scale,(102,A0)     ; Vergrößerung ja/nein in <a href="006002.html">LINEA</a>.scale
move.w    chup,(104,A0)      ; Rotationswinkel in <a href="006002.html">LINEA</a>.chup
move.w    text_fg,(106,A0)   ; Textfarbe in <a href="006002.html">LINEA</a>.text_fg
move.l    scrtchp,(108,A0)   ; Puffer in <a href="006002.html">LINEA</a>.scrtchp
move.w    scrpt2,(112,A0)    ; <a href="indexudo.html">Index</a> in Puffermitte in <a href="006002.html">LINEA</a>.scrpt2
move.w    text_bg,(114,A0)   ; Hintergrundfarbe in <a href="006002.html">LINEA</a>.text_bg
dc.w      $A008              ; <a href="006.html">Line-A</a> Opcode
movem.l   (A7)+,D0-D2/A0-A2  ; Register restaurieren
</pre>


</td></tr>
</table>

<hr>

<a id="UDO_nav_hm_FOOT" href="index.html"><img src="udo_hm.gif" alt="Home" title="Home" border="0" width="24" height="24"></a><a id="UDO_nav_up_FOOT" href="006.html"><img src="udo_up.gif" alt="Line-A" title="Line-A" border="0" width="24" height="24"></a><a id="UDO_nav_lf_FOOT" href="00600c.html"><img src="udo_lf.gif" alt="Bit block transfer" title="Bit block transfer" border="0" width="24" height="24"></a><a id="UDO_nav_rg_FOOT" href="00600e.html"><img src="udo_rg.gif" alt="Show mouse" title="Show mouse" border="0" width="24" height="24"></a></body>
</html>
