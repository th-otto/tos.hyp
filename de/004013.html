<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html lang="de">
<head>
<title>
Die Anleitung zum TOS: Tastaturfunktionen
</title>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta http-equiv="Content-Language" content="de">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<meta name="Generator" content="UDO 7.04 (1296) for Linux">
</head>
<body>
<? include "/var/www/banner.php"; ?>

<a id="UDO_nav_hm_HEAD" href="index.html"><img src="udo_hm.gif" alt="Home" title="Home" border="0" width="24" height="24"></a><a id="UDO_nav_up_HEAD" href="004.html"><img src="udo_up.gif" alt="XBIOS" title="XBIOS" border="0" width="24" height="24"></a><a id="UDO_nav_lf_HEAD" href="004012.html"><img src="udo_lf.gif" alt="Spezialbefehle" title="Spezialbefehle" border="0" width="24" height="24"></a><a id="UDO_nav_rg_HEAD" href="004014.html"><img src="udo_rg.gif" alt="XBIOS-Funktionsliste" title="XBIOS-Funktionsliste" border="0" width="24" height="24"></a>
<hr>

<h1><a name="Tastaturfunktionen"></a>4.19 Tastaturfunktionen</h1>
<table>
<tr><td nowrap="nowrap" valign="top">• <a href="#Bioskeys">Bioskeys</a></td>
<td valign="top">Bios-Tabelle für Tastaturcodes zurücksetzen.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#Kbrate">Kbrate</a></td>
<td valign="top">Auto-Repeat der Tastatur ändern oder ermitteln.</td></tr>

<tr><td nowrap="nowrap" valign="top">• <a href="#Keytbl">Keytbl</a></td>
<td valign="top">Neue Tabelle für Tastaturcodes vorgeben.

</td></tr>
</table>

<p>Querverweis: <a href="010001.html">ASCII-Tabelle</a> &nbsp; <a href="010002.html">Scan-Code Tabelle</a></p>

<h3><a name="Bioskeys"></a>4.19.1 Bioskeys</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»Bios standard keys« - Tastatur reinitialisieren.</td></tr>

<tr><td nowrap="nowrap" valign="top">Xbiosnummer:</td>
<td valign="top">24</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top">void Bioskeys( void );</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top">Bioskeys ist eine XBIOS-Routine zur Re-Initialisierung der
Tastatur-Codes. Dies ist meist nur dann nötig, wenn die Tastatur mit
Hilfe der Funktion <a href="#Keytbl">Keytbl</a> umprogrammiert wurde.</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top">Die Funktion liefert kein Ergebnis.</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top">Alle TOS Versionen</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"><a href="#Tastaturfunktionen">Tastaturfunktionen</a></td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"><a href="#Bindings_20f_C3_BCr_20Bioskeys">Binding</a> &nbsp; <a href="#Keytbl">Keytbl</a>

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Bioskeys"></a>4.19.1.1 Bindings für Bioskeys</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">#include <tos.h><br><br>

void <a href="#Bioskeys">Bioskeys</a>( void );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>move.w    #24,-(sp)    ; Offset 0
trap      #14          ; <a href="004.html">XBIOS</a> aufrufen
addq.l    #2,sp        ; Stack korrigieren
</pre>


</td></tr>
</table>

<h3><a name="Kbrate"></a>4.19.2 Kbrate</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»keyboard rate« - legt die Autorepeat-Rate der Tastatur fest.</td></tr>

<tr><td nowrap="nowrap" valign="top">Xbiosnummer:</td>
<td valign="top">35</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top">int16_t Kbrate( int16_t initial, int16_t repeat );</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top">Die XBIOS-Routine Kbrate ermittelt oder ändert die aktuelle
Auto-Repeat-Geschwindigkeit der Tastatur. Es gilt:<table>
<tr><td nowrap="nowrap" valign="top">Parameter</td>
<td valign="top">Bedeutung</td></tr>

<tr><td nowrap="nowrap" valign="top">initial</td>
<td valign="top">Ansprechzeit bis zur ersten Wiederholung (in 20ms). Ein Wert
von -1 bedeutet keine Veränderung.</td></tr>

<tr><td nowrap="nowrap" valign="top">repeat</td>
<td valign="top">Wiederholungsgeschwindigkeit in 20ms. Ein Wert von -1 bedeutet
in diesem Zusammenhang keine Veränderung.

</td></tr>
</table>

</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top">Die Funktion liefert als Ergebnis die Einstellung des
Auto-Repeat-Modus, und zwar wie folgt:<br><br>


<div align="left">
<table border="0">
<tr>
  <td align="left" valign="top">Bits 0..7&nbsp;:</td>
  <td align="left" valign="top">bisheriger repeat-Wert</td>
</tr>
<tr>
  <td align="left" valign="top">Bits 8..15:</td>
  <td align="left" valign="top">bisheriger initial-Wert</td>
</tr>
</table>
</div>

</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top">Alle TOS Versionen.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"><a href="#Tastaturfunktionen">Tastaturfunktionen</a></td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"><a href="#Bindings_20f_C3_BCr_20Kbrate">Binding</a>

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Kbrate"></a>4.19.2.1 Bindings für Kbrate</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">#include <tos.h><br><br>

int16_t <a href="#Kbrate">Kbrate</a>( int16_t initial, int16_t repeat );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>move.w    repeat,-(sp)  ; Offset 4
move.w    initial,-(sp) ; Offset 2
move.w    #35,-(sp)     ; Offset 0
trap      #14           ; <a href="004.html">XBIOS</a> aufrufen
addq.l    #6,sp         ; Stack korrigieren
</pre>


</td></tr>
</table>

<h3><a name="Keytbl"></a>4.19.3 Keytbl</h3>
<table>
<tr><td nowrap="nowrap" valign="top">Name:</td>
<td valign="top">»key table« - definiert die Umsetzungstabelle der Tastatur
von Scan-Codes in Tastatur-Codes.</td></tr>

<tr><td nowrap="nowrap" valign="top">Xbiosnummer:</td>
<td valign="top">16</td></tr>

<tr><td nowrap="nowrap" valign="top">Deklaration:</td>
<td valign="top"><a href="004015.html#KEYTAB">KEYTAB</a> *Keytbl( void *unshift, void *shift, void *capslock );</td></tr>

<tr><td nowrap="nowrap" valign="top">Beschreibung:</td>
<td valign="top">Keytbl ist eine XBIOS-Funktion mit deren Hilfe eine neue
Tastatur-Tabelle für die Umsetzung von Scan-Codes in Tastatur-Codes
vorgenommen werden kann. Es gilt:<table>
<tr><td nowrap="nowrap" valign="top">Parameter</td>
<td valign="top">Bedeutung</td></tr>

<tr><td nowrap="nowrap" valign="top">&nbsp;</td>
<td valign="top">&nbsp;</td></tr>

<tr><td nowrap="nowrap" valign="top">unshift</td>
<td valign="top">Zeiger auf unshift-Tabelle, oder -1</td></tr>

<tr><td nowrap="nowrap" valign="top">shift</td>
<td valign="top">Zeiger auf shift-Tabelle, oder -1</td></tr>

<tr><td nowrap="nowrap" valign="top">capslock</td>
<td valign="top">Zeiger auf capslock-Tabelle, oder -1

</td></tr>
</table>

<br><br>

<b>Hinweis:</b> Ein Code wird umgerechnet, indem der Scancode der
betreffenden Taste als <a href="indexudo.html">Index</a> in die Tabelle (von ASCII-Zeichen)
verwendet wird. Jede der Tabellen besitzt Platz für 128 Einträge,
obwohl Tastenkombinationen mit höherem Scancode existieren.</td></tr>

<tr><td nowrap="nowrap" valign="top">Ergebnis:</td>
<td valign="top">Die Funktion liefert als Ergebnis einen Zeiger auf die Struktur
<a href="004015.html#KEYTAB">KEYTAB</a>.</td></tr>

<tr><td nowrap="nowrap" valign="top">Verfügbar:</td>
<td valign="top">Alle TOS Versionen.</td></tr>

<tr><td nowrap="nowrap" valign="top">Gruppe:</td>
<td valign="top"><a href="#Tastaturfunktionen">Tastaturfunktionen</a></td></tr>

<tr><td nowrap="nowrap" valign="top">Querverweis:</td>
<td valign="top"><a href="#Bindings_20f_C3_BCr_20Keytbl">Binding</a> &nbsp; <a href="#Bioskeys">Bioskeys</a> &nbsp; <a href="010001.html">ASCII-Tabelle</a> &nbsp; <a href="010002.html">Scan-Codes</a>

</td></tr>
</table>

<h4><a name="Bindings_20f_C3_BCr_20Keytbl"></a>4.19.3.1 Bindings für Keytbl</h4>
<table>
<tr><td nowrap="nowrap" valign="top">C:</td>
<td valign="top">#include <tos.h><br><br>

<a href="004015.html#KEYTAB">KEYTAB</a> *<a href="#Keytbl">Keytbl</a>( void *unshift, void *shift, void *capslock );</td></tr>

<tr><td nowrap="nowrap" valign="top">Assembler:</td>
<td valign="top"><pre>pea       capslock     ; Offset 10
pea       shift        ; Offset  6
pea       unshift      ; Offset  2
move.w    #16,-(sp)    ; Offset  0
trap      #14          ; <a href="004.html">XBIOS</a> aufrufen
lea       $E(sp),sp    ; Stack korrigieren
</pre>


</td></tr>
</table>

<hr>

<a id="UDO_nav_hm_FOOT" href="index.html"><img src="udo_hm.gif" alt="Home" title="Home" border="0" width="24" height="24"></a><a id="UDO_nav_up_FOOT" href="004.html"><img src="udo_up.gif" alt="XBIOS" title="XBIOS" border="0" width="24" height="24"></a><a id="UDO_nav_lf_FOOT" href="004012.html"><img src="udo_lf.gif" alt="Spezialbefehle" title="Spezialbefehle" border="0" width="24" height="24"></a><a id="UDO_nav_rg_FOOT" href="004014.html"><img src="udo_rg.gif" alt="XBIOS-Funktionsliste" title="XBIOS-Funktionsliste" border="0" width="24" height="24"></a></body>
</html>
